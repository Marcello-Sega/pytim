
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Observables &#8212; Pytim 1.0.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/classic.css" />
    <link rel="stylesheet" type="text/css" href="_static/plot_directive.css" />
    
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    
    <link rel="shortcut icon" href="_static/pytim.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Datafiles" href="datafiles.html" />
    <link rel="prev" title="SimpleInterface" href="SimpleInterface.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="datafiles.html" title="Datafiles"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="SimpleInterface.html" title="SimpleInterface"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Pytim 1.0.0 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Observables</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="observables">
<h1>Observables<a class="headerlink" href="#observables" title="Permalink to this heading">¶</a></h1>
<section id="module-pytim.observables.rdf">
<span id="radial-distribution-functions"></span><h2>Radial Distribution Functions<a class="headerlink" href="#module-pytim.observables.rdf" title="Permalink to this heading">¶</a></h2>
<section id="module-rdf">
<h3>Module: RDF<a class="headerlink" href="#module-rdf" title="Permalink to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pytim.observables.rdf.RDF">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pytim.observables.rdf.</span></span><span class="sig-name descname"><span class="pre">RDF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">universe</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_distance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'full'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">75</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observable2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytim/observables/rdf.html#RDF"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytim.observables.rdf.RDF" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates a radial distribution function of some observable from two
groups.</p>
<p>The two functions must return an array (of scalars or of vectors)
having the same size of the group. The scalar product between the
two functions is used to weight the distriution function.</p>
<div class="math">
<p><img src="_images/math/08097b27e980b8f8f670a2060c1331858ffe04d7.png" alt="g(r) = \frac{1}{N}\left\langle \sum_{i\neq j} \delta(r-|r_i-r_j|)\
  f_1(r_i,v_i)\cdot f_2(r_j,v_j) \right\rangle"/></p>
</div><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>max_radius</strong> (<em>double</em>) – compute the rdf up to this distance.
If ‘full’ is supplied (default) computes
it up to half of the smallest box side.</p></li>
<li><p><strong>nbins</strong> (<em>int</em>) – number of bins</p></li>
<li><p><strong>observable</strong> (<em>Observable</em>) – observable for the first group</p></li>
<li><p><strong>observable2</strong> (<em>Observable</em>) – observable for the second group</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">MDAnalysis</span> <span class="k">as</span> <span class="nn">mda</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytim</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pytim</span> <span class="kn">import</span> <span class="n">observables</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pytim.datafiles</span> <span class="kn">import</span> <span class="o">*</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="n">WATER_GRO</span><span class="p">,</span><span class="n">WATER_XTC</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">oxygens</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s2">&quot;name OW&quot;</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nres</span> <span class="o">=</span> <span class="n">observables</span><span class="o">.</span><span class="n">NumberOfResidues</span><span class="p">()</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdf</span> <span class="o">=</span> <span class="n">observables</span><span class="o">.</span><span class="n">RDF</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">nbins</span><span class="o">=</span><span class="mi">120</span><span class="p">,</span><span class="n">observable</span><span class="o">=</span><span class="n">nres</span><span class="p">,</span><span class="n">observable2</span><span class="o">=</span><span class="n">nres</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">interface</span> <span class="o">=</span> <span class="n">pytim</span><span class="o">.</span><span class="n">ITIM</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">2.</span><span class="p">,</span><span class="n">group</span><span class="o">=</span><span class="n">oxygens</span><span class="p">,</span><span class="n">cluster_cut</span><span class="o">=</span><span class="mf">3.5</span><span class="p">,</span><span class="n">molecular</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">ts</span> <span class="ow">in</span> <span class="n">u</span><span class="o">.</span><span class="n">trajectory</span><span class="p">[::</span><span class="mi">50</span><span class="p">]:</span>
<span class="gp">... </span>    <span class="n">layer</span><span class="o">=</span><span class="n">interface</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">... </span>    <span class="n">rdf</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">layer</span><span class="p">,</span><span class="n">layer</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdf</span><span class="o">.</span><span class="n">count</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="s1">&#39;RDF3D.dat&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">rdf</span><span class="o">.</span><span class="n">bins</span><span class="p">,</span><span class="n">rdf</span><span class="o">.</span><span class="n">rdf</span><span class="p">)))</span>
</pre></div>
</div>
<p>Note that one needs to specify neither both groups, not both observables.
If only the first group (observable) is specified, the second is assumed
to be the same as the first, as in the following example:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rdf1</span> <span class="o">=</span> <span class="n">observables</span><span class="o">.</span><span class="n">RDF</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">observable</span><span class="o">=</span><span class="n">nres</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdf2</span> <span class="o">=</span> <span class="n">observables</span><span class="o">.</span><span class="n">RDF</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">observable</span><span class="o">=</span><span class="n">nres</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdf3</span> <span class="o">=</span> <span class="n">observables</span><span class="o">.</span><span class="n">RDF</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">observable</span><span class="o">=</span><span class="n">nres</span><span class="p">,</span><span class="n">observable2</span><span class="o">=</span><span class="n">nres</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdf1</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">layer</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdf2</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">layer</span><span class="p">,</span><span class="n">layer</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdf3</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">layer</span><span class="p">,</span><span class="n">layer</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">rdf1</span><span class="o">.</span><span class="n">rdf</span><span class="p">[:]</span><span class="o">==</span><span class="n">rdf2</span><span class="o">.</span><span class="n">rdf</span><span class="p">[:]))</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">rdf1</span><span class="o">.</span><span class="n">rdf</span><span class="p">[:]</span><span class="o">==</span><span class="n">rdf3</span><span class="o">.</span><span class="n">rdf</span><span class="p">[:]))</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pytim.observables.rdf.oldRDF">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pytim.observables.rdf.</span></span><span class="sig-name descname"><span class="pre">oldRDF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">universe</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">75</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'full'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observable2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kargs1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kargs2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytim/observables/rdf.html#oldRDF"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytim.observables.rdf.oldRDF" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates a radial distribution function of some observable from two
groups.</p>
<p>The two functions must return an array (of scalars or of vectors)
having the same size of the group. The scalar product between the
two functions is used to weight the distriution function.</p>
<div class="math">
<p><img src="_images/math/08097b27e980b8f8f670a2060c1331858ffe04d7.png" alt="g(r) = \frac{1}{N}\left\langle \sum_{i\neq j} \delta(r-|r_i-r_j|)\
  f_1(r_i,v_i)\cdot f_2(r_j,v_j) \right\rangle"/></p>
</div><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>max_radius</strong> (<em>double</em>) – compute the rdf up to this distance.
If ‘full’ is supplied (default) computes
it up to half of the smallest box side.</p></li>
<li><p><strong>nbins</strong> (<em>int</em>) – number of bins</p></li>
<li><p><strong>observable</strong> (<em>Observable</em>) – observable for the first group</p></li>
<li><p><strong>observable2</strong> (<em>Observable</em>) – observable for the second group</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">MDAnalysis</span> <span class="k">as</span> <span class="nn">mda</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytim</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pytim</span> <span class="kn">import</span> <span class="n">observables</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pytim.datafiles</span> <span class="kn">import</span> <span class="o">*</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="n">WATER_GRO</span><span class="p">,</span><span class="n">WATER_XTC</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">oxygens</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s2">&quot;name OW&quot;</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nres</span> <span class="o">=</span> <span class="n">observables</span><span class="o">.</span><span class="n">NumberOfResidues</span><span class="p">()</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdf</span> <span class="o">=</span> <span class="n">observables</span><span class="o">.</span><span class="n">RDF</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">nbins</span><span class="o">=</span><span class="mi">120</span><span class="p">,</span><span class="n">observable</span><span class="o">=</span><span class="n">nres</span><span class="p">,</span><span class="n">observable2</span><span class="o">=</span><span class="n">nres</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">interface</span> <span class="o">=</span> <span class="n">pytim</span><span class="o">.</span><span class="n">ITIM</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">2.</span><span class="p">,</span><span class="n">group</span><span class="o">=</span><span class="n">oxygens</span><span class="p">,</span><span class="n">cluster_cut</span><span class="o">=</span><span class="mf">3.5</span><span class="p">,</span><span class="n">molecular</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">ts</span> <span class="ow">in</span> <span class="n">u</span><span class="o">.</span><span class="n">trajectory</span><span class="p">[::</span><span class="mi">50</span><span class="p">]:</span>
<span class="gp">... </span>    <span class="n">layer</span><span class="o">=</span><span class="n">interface</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">... </span>    <span class="n">rdf</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">layer</span><span class="p">,</span><span class="n">layer</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdf</span><span class="o">.</span><span class="n">count</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="s1">&#39;RDF3D.dat&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">rdf</span><span class="o">.</span><span class="n">bins</span><span class="p">,</span><span class="n">rdf</span><span class="o">.</span><span class="n">rdf</span><span class="p">)))</span>
</pre></div>
</div>
<p>Note that one needs to specify neither both groups, not both observables.
If only the first group (observable) is specified, the second is assumed
to be the same as the first, as in the following example:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rdf1</span> <span class="o">=</span> <span class="n">observables</span><span class="o">.</span><span class="n">RDF</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">observable</span><span class="o">=</span><span class="n">nres</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdf2</span> <span class="o">=</span> <span class="n">observables</span><span class="o">.</span><span class="n">RDF</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">observable</span><span class="o">=</span><span class="n">nres</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdf3</span> <span class="o">=</span> <span class="n">observables</span><span class="o">.</span><span class="n">RDF</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">observable</span><span class="o">=</span><span class="n">nres</span><span class="p">,</span><span class="n">observable2</span><span class="o">=</span><span class="n">nres</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdf1</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">layer</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdf2</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">layer</span><span class="p">,</span><span class="n">layer</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdf3</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">layer</span><span class="p">,</span><span class="n">layer</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">rdf1</span><span class="o">.</span><span class="n">rdf</span><span class="p">[:]</span><span class="o">==</span><span class="n">rdf2</span><span class="o">.</span><span class="n">rdf</span><span class="p">[:]))</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">rdf1</span><span class="o">.</span><span class="n">rdf</span><span class="p">[:]</span><span class="o">==</span><span class="n">rdf3</span><span class="o">.</span><span class="n">rdf</span><span class="p">[:]))</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

</section>
<span class="target" id="module-pytim.observables.rdf2d"></span><section id="module-rdf2d">
<h3>Module: RDF2D<a class="headerlink" href="#module-rdf2d" title="Permalink to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pytim.observables.rdf2d.RDF2D">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pytim.observables.rdf2d.</span></span><span class="sig-name descname"><span class="pre">RDF2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">universe</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">75</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'full'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">excluded_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">true2D</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kargs1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kargs2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytim/observables/rdf2d.html#RDF2D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytim.observables.rdf2d.RDF2D" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates a radial distribution function of some observable from two
groups, projected on a plane.</p>
<p>The two functions must return an array (of scalars or of vectors)
having the same size of the group. The scalar product between the
two functions is used to weight the distriution function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nbins</strong> (<em>int</em>) – number of bins</p></li>
<li><p><strong>excluded_dir</strong> (<em>char</em>) – project position vectors onto the plane
orthogonal to ‘z’,’y’ or ‘z’</p></li>
<li><p><strong>observable</strong> (<em>Observable</em>) – observable for group 1</p></li>
<li><p><strong>observable2</strong> (<em>Observable</em>) – observable for group 2</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">MDAnalysis</span> <span class="k">as</span> <span class="nn">mda</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytim</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pytim</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pytim.datafiles</span> <span class="kn">import</span> <span class="o">*</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="n">WATER_GRO</span><span class="p">,</span><span class="n">WATER_XTC</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">oxygens</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s2">&quot;name OW&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">interface</span> <span class="o">=</span> <span class="n">pytim</span><span class="o">.</span><span class="n">ITIM</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">2.</span><span class="p">,</span><span class="n">group</span><span class="o">=</span><span class="n">oxygens</span><span class="p">,</span>        <span class="n">cluster_cut</span><span class="o">=</span><span class="mf">3.5</span><span class="p">,</span><span class="n">molecular</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdf</span> <span class="o">=</span> <span class="n">observables</span><span class="o">.</span><span class="n">RDF2D</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">nbins</span><span class="o">=</span><span class="mi">250</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">ts</span> <span class="ow">in</span> <span class="n">u</span><span class="o">.</span><span class="n">trajectory</span><span class="p">[::</span><span class="mi">50</span><span class="p">]</span> <span class="p">:</span>
<span class="gp">... </span>    <span class="n">layer</span><span class="o">=</span><span class="n">interface</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">... </span>    <span class="n">rdf</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">layer</span><span class="p">,</span><span class="n">layer</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdf</span><span class="o">.</span><span class="n">count</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="s1">&#39;RDF.dat&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">rdf</span><span class="o">.</span><span class="n">bins</span><span class="p">,</span><span class="n">rdf</span><span class="o">.</span><span class="n">rdf</span><span class="p">)))</span>
</pre></div>
</div>
<p>This results in the following RDF (sampling more frequently):</p>
<p>(<a class="reference download internal" download="" href="_downloads/2ab7844103ec34a3bedecb58ede241bd/observables-1.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="_downloads/a0417e69e8efc6f2824a65d95bc56248/observables-1.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="_downloads/c5771fe6ab57abef596361dda28e17b2/observables-1.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="_downloads/9881bf5bf80958ebac55b55b77669b98/observables-1.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="_images/observables-1.png" class="plot-directive" src="_images/observables-1.png" />
</figure>
</dd></dl>

</section>
</section>
<section id="module-pytim.observables.profile">
<span id="profiles"></span><h2>Profiles<a class="headerlink" href="#module-pytim.observables.profile" title="Permalink to this heading">¶</a></h2>
<section id="module-profile">
<h3>Module: Profile<a class="headerlink" href="#module-profile" title="Permalink to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pytim.observables.profile.Profile">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pytim.observables.profile.</span></span><span class="sig-name descname"><span class="pre">Profile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">direction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interface</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symmetry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">MCnorm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytim/observables/profile.html#Profile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytim.observables.profile.Profile" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the profile (normal, or intrinsic) of a given observable
across the simulation box.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>observable</strong> (<em>Observable</em>) – <a class="reference internal" href="#pytim.observables.Number" title="pytim.observables.Number"><code class="xref py py-class docutils literal notranslate"><span class="pre">Number</span></code></a>,
<a class="reference internal" href="#pytim.observables.Mass" title="pytim.observables.Mass"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mass</span></code></a>, or
any other observable:
calculate the profile of this quantity. If
None is supplied, it defaults to the number
density. The number density is always
calculated on a per atom basis.</p></li>
<li><p><strong>interface</strong> (<a class="reference internal" href="ITIM.html#pytim.itim.ITIM" title="pytim.itim.ITIM"><em>ITIM</em></a>) – if provided, calculate the intrinsic
profile with respect to the first layers</p></li>
<li><p><strong>direction</strong> (<em>str</em>) – ‘x’,’y’, or ‘z’ : calculate the profile
along this direction. (default: ‘z’ or
the normal direction of the interface,
if provided.</p></li>
<li><p><strong>MCnorm</strong> (<em>bool</em>) – if True (default) use a simple Monte Carlo
estimate the effective volumes of the bins.</p></li>
</ul>
</dd>
<dt class="field-even">Keyword Arguments<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p>MCpoints (int) –
number of points used for MC normalization (default, 10x the number
of atoms in the universe)</p></li>
</ul>
</dd>
</dl>
<p>Example (non-intrinsic, total profile + first 4 layers ):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">MDAnalysis</span> <span class="k">as</span> <span class="nn">mda</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytim</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>   <span class="nn">pytim.datafiles</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>   <span class="nn">pytim.observables</span> <span class="kn">import</span> <span class="n">Profile</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="n">WATER_GRO</span><span class="p">,</span><span class="n">WATER_XTC</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;name OW&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># here we calculate the profiles of oxygens only (note molecular=False)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inter</span> <span class="o">=</span> <span class="n">pytim</span><span class="o">.</span><span class="n">ITIM</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">group</span><span class="o">=</span><span class="n">g</span><span class="p">,</span><span class="n">max_layers</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">centered</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">molecular</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># We create a list of 5 profiles, one for the total and 4 for the first</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># 4 layers.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Note that by default Profile() uses the number of atoms as an observable</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Layers</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">Layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Profile</span><span class="p">())</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Go through the trajectory, center the liquid slab and sample the profiles</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">ts</span> <span class="ow">in</span> <span class="n">u</span><span class="o">.</span><span class="n">trajectory</span><span class="p">[::</span><span class="mi">50</span><span class="p">]:</span>
<span class="gp">... </span>        <span class="c1"># this shifts the system so that the center of mass of the liquid slab</span>
<span class="gp">... </span>        <span class="c1"># is in the middle of the box</span>
<span class="gp">... </span>        <span class="n">inter</span><span class="o">.</span><span class="n">center</span><span class="p">()</span>
<span class="gp">...</span>
<span class="gp">... </span>        <span class="n">Layers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">Layers</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">layers</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">])</span>
<span class="gp">... </span>        <span class="n">Layers</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">layers</span> <span class="o">==</span> <span class="mi">2</span> <span class="p">])</span>
<span class="gp">... </span>        <span class="n">Layers</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">layers</span> <span class="o">==</span> <span class="mi">3</span> <span class="p">])</span>
<span class="gp">... </span>        <span class="n">Layers</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">layers</span> <span class="o">==</span> <span class="mi">4</span> <span class="p">])</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">density</span><span class="o">=</span><span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">L</span> <span class="ow">in</span> <span class="n">Layers</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">low</span><span class="p">,</span><span class="n">up</span><span class="p">,</span><span class="n">avg</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">get_values</span><span class="p">(</span><span class="n">binwidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">density</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">avg</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># (low + up )/2 is the middle of the bin</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="s1">&#39;profile.dat&#39;</span><span class="p">,</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">low</span><span class="p">,</span><span class="n">up</span><span class="p">,</span><span class="n">density</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">density</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">density</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">density</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="n">density</span><span class="p">[</span><span class="mi">4</span><span class="p">])))</span>
</pre></div>
</div>
<p>This results in the following profile (sampling more often and zooming close to the interface border)</p>
<a class="reference internal image-reference" href="_images/nonintrinsic_water.png"><img alt="_images/nonintrinsic_water.png" src="_images/nonintrinsic_water.png" style="width: 50%;" /></a>
<p>Example: the intrinsic profile of a LJ liquid/vapour interface:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">MDAnalysis</span> <span class="k">as</span> <span class="nn">mda</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytim</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>   <span class="nn">pytim.datafiles</span> <span class="kn">import</span> <span class="n">LJ_GRO</span><span class="p">,</span> <span class="n">LJ_SHORT_XTC</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>   <span class="nn">pytim.observables</span> <span class="kn">import</span> <span class="n">Profile</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">u</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="n">LJ_GRO</span><span class="p">,</span><span class="n">LJ_SHORT_XTC</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inter</span> <span class="o">=</span> <span class="n">pytim</span><span class="o">.</span><span class="n">ITIM</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span><span class="n">cluster_cut</span><span class="o">=</span><span class="mf">4.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">profile</span> <span class="o">=</span> <span class="n">Profile</span><span class="p">(</span><span class="n">interface</span><span class="o">=</span><span class="n">inter</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">ts</span> <span class="ow">in</span> <span class="n">u</span><span class="o">.</span><span class="n">trajectory</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">profile</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">low</span><span class="p">,</span> <span class="n">up</span><span class="p">,</span> <span class="n">avg</span> <span class="o">=</span> <span class="n">profile</span><span class="o">.</span><span class="n">get_values</span><span class="p">(</span><span class="n">binwidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="s1">&#39;profile.dat&#39;</span><span class="p">,</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">low</span><span class="p">,</span><span class="n">up</span><span class="p">,</span><span class="n">avg</span><span class="p">)))</span>
</pre></div>
</div>
<p>This results in the following profile (sampling a longer trajectory):</p>
<a class="reference internal image-reference" href="_images/intrinsic_lj.png"><img alt="_images/intrinsic_lj.png" src="_images/intrinsic_lj.png" style="width: 50%;" /></a>
<p>Note the missing point at position = 0, this is the delta-function contirbution.
Negative positions are within the liquid phase, while positive ones are in the vapour
phase.</p>
</dd></dl>

</section>
</section>
<section id="time-correlation-functions">
<h2>Time Correlation Functions<a class="headerlink" href="#time-correlation-functions" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pytim.observables.Correlator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pytim.observables.</span></span><span class="sig-name descname"><span class="pre">Correlator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">universe</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reference</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytim/observables/correlator.html#Correlator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytim.observables.Correlator" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the (self) correlation of an observable (scalar or vector)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>observable</strong> (<em>Observable</em>) – compute the autocorrelation of this observable.
If the observable is None and the reference
is not, the survival probability is computed.</p></li>
<li><p><strong>normalize</strong> (<em>bool</em>) – normalize the correlation to 1 at <img class="math" src="_images/math/34656d3b192f255d26caf50b0ed5476d5d789d11.png" alt="t=0"/></p></li>
<li><p><strong>reference</strong> (<em>AtomGroup</em>) – if the group passed to the sample() function
changes its composition along the trajectory
(such as a layer group), a reference group that
includes all atoms that could appear in the
variable group must be passed, in order to
provide a proper normalization. See the example
below.</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytim</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">MDAnalysis</span> <span class="k">as</span> <span class="nn">mda</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pytim.datafiles</span> <span class="kn">import</span> <span class="n">WATERSMALL_GRO</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pytim.utilities</span> <span class="kn">import</span> <span class="n">lap</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#  tmpdir here is specified only for travis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">WATERSMALL_TRR</span> <span class="o">=</span> <span class="n">pytim</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">pytim_data</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="s1">&#39;WATERSMALL_LONG_TRR&#39;</span><span class="p">,</span><span class="n">tmpdir</span><span class="o">=</span><span class="s1">&#39;./&#39;</span><span class="p">)</span> 
<span class="go">checking presence of a cached copy...</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">u</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="n">WATERSMALL_GRO</span><span class="p">,</span><span class="n">WATERSMALL_TRR</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;name OW&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">velocity</span> <span class="o">=</span> <span class="n">pytim</span><span class="o">.</span><span class="n">observables</span><span class="o">.</span><span class="n">Velocity</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">corr</span> <span class="o">=</span> <span class="n">pytim</span><span class="o">.</span><span class="n">observables</span><span class="o">.</span><span class="n">Correlator</span><span class="p">(</span><span class="n">observable</span><span class="o">=</span><span class="n">velocity</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">u</span><span class="o">.</span><span class="n">trajectory</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
<span class="gp">... </span>    <span class="n">corr</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vacf</span> <span class="o">=</span> <span class="n">corr</span><span class="o">.</span><span class="n">correlation</span><span class="p">()</span>
</pre></div>
</div>
<p>This produces the following (steps of 1 fs):</p>
<p>(<a class="reference download internal" download="" href="_downloads/a2ff363b85b3268cb9d41f0b8ace123a/observables-2.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="_downloads/fc0f6ab08174b4deae75a58821da483e/observables-2.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="_downloads/d6018e481be019b0d00210a160470304/observables-2.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="_downloads/4059c898e2e4eb471da85d836c226d86/observables-2.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="_images/observables-2.png" class="plot-directive" src="_images/observables-2.png" />
</figure>
<p>In order to compute the correlation for variable groups, one should proceed
as follows:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">corr</span> <span class="o">=</span> <span class="n">pytim</span><span class="o">.</span><span class="n">observables</span><span class="o">.</span><span class="n">Correlator</span><span class="p">(</span><span class="n">observable</span><span class="o">=</span><span class="n">velocity</span><span class="p">,</span><span class="n">reference</span><span class="o">=</span><span class="n">g</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># notice the molecular=False switch, in order for the</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># layer group to be made of oxygen atoms only and match</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># the reference group</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inter</span> <span class="o">=</span> <span class="n">pytim</span><span class="o">.</span><span class="n">ITIM</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">group</span><span class="o">=</span><span class="n">g</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span><span class="n">molecular</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># example only: sample longer for smooth results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">u</span><span class="o">.</span><span class="n">trajectory</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">10</span><span class="p">]:</span>
<span class="gp">... </span>    <span class="n">corr</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">inter</span><span class="o">.</span><span class="n">atoms</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">layer_vacf</span> <span class="o">=</span> <span class="n">corr</span><span class="o">.</span><span class="n">correlation</span><span class="p">()</span>
</pre></div>
</div>
<p>In order to compute the survival probability of some atoms in a layer, it
is possible to pass observable=None together with the reference group:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">corr</span> <span class="o">=</span> <span class="n">pytim</span><span class="o">.</span><span class="n">observables</span><span class="o">.</span><span class="n">Correlator</span><span class="p">(</span><span class="n">observable</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">reference</span> <span class="o">=</span> <span class="n">g</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inter</span> <span class="o">=</span> <span class="n">pytim</span><span class="o">.</span><span class="n">ITIM</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">group</span><span class="o">=</span><span class="n">g</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">molecular</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span> <span class="c1"># example only: sample longer for smooth results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">u</span><span class="o">.</span><span class="n">trajectory</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">10</span><span class="p">]:</span>
<span class="gp">... </span>    <span class="n">corr</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">inter</span><span class="o">.</span><span class="n">atoms</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">survival</span> <span class="o">=</span> <span class="n">corr</span><span class="o">.</span><span class="n">correlation</span><span class="p">()</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="pytim.observables.Correlator.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">group</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytim/observables/correlator.html#Correlator.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytim.observables.Correlator.sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Sample the timeseries for the autocorrelation function</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>group</strong> (<em>AtomGroup</em>) – compute the observable using this group</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytim.observables.Correlator.correlation">
<span class="sig-name descname"><span class="pre">correlation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">normalized</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">continuous</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytim/observables/correlator.html#Correlator.correlation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytim.observables.Correlator.correlation" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the autocorrelation from the sampled data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>normalized</strong> (<em>bool</em>) – normalize the correlation function to:
its zero-time value for regular
correlations; to the average of the
characteristic function for the
survival probability.</p></li>
<li><p><strong>continuous</strong> (<em>bool</em>) – applies only when a reference group has
been specified: if True (default) the
contribution of a particle at time lag
<img class="math" src="_images/math/b68390d287204f2237dc0c5192d501f68d450204.png" alt="\tau=t_1-t_0"/> is considered
only if the particle did not leave the
reference group between <img class="math" src="_images/math/ec0f4b5ec85f2c2005b5f78c12cf51c1cb2bb167.png" alt="t_0"/> and
<img class="math" src="_images/math/802e1ea255de5805b557aea4e0ad643e51ea0450.png" alt="t_1"/>. If False, the intermittent
correlation is calculated, and the
above restriction is released.</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># We build a fake trajectory to test the various options:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">MDAnalysis</span> <span class="k">as</span> <span class="nn">mda</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytim</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pytim.datafiles</span> <span class="kn">import</span> <span class="n">WATER_GRO</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pytim.observables</span> <span class="kn">import</span> <span class="n">Correlator</span><span class="p">,</span> <span class="n">Velocity</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">suppress</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="n">WATER_GRO</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="o">.</span><span class="n">velocities</span><span class="o">*=</span><span class="mf">0.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="o">.</span><span class="n">velocities</span><span class="o">+=</span><span class="mf">1.0</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># velocity autocorrelation along x, variable group</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vv</span> <span class="o">=</span> <span class="n">Correlator</span><span class="p">(</span><span class="n">observable</span><span class="o">=</span><span class="n">Velocity</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">reference</span><span class="o">=</span><span class="n">g</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nn</span> <span class="o">=</span> <span class="n">Correlator</span><span class="p">(</span><span class="n">reference</span><span class="o">=</span><span class="n">g</span><span class="p">)</span> <span class="c1"># survival probability in group g</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="p">[</span><span class="n">vv</span><span class="p">,</span><span class="n">nn</span><span class="p">]:</span>
<span class="gp">... </span>    <span class="n">c</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>     <span class="c1"># t=0</span>
<span class="gp">... </span>    <span class="n">c</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>     <span class="c1"># t=1</span>
<span class="gp">... </span>    <span class="n">c</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">g</span><span class="p">[:</span><span class="mi">1</span><span class="p">])</span> <span class="c1"># t=2, exclude the second particle</span>
<span class="gp">... </span>    <span class="n">g</span><span class="o">.</span><span class="n">velocities</span> <span class="o">/=</span> <span class="mf">2.</span> <span class="c1"># from now on v=0.5</span>
<span class="gp">... </span>    <span class="n">c</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>     <span class="c1"># t=3</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
<p>The timeseries sampled can be accessed using:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">vv</span><span class="o">.</span><span class="n">timeseries</span><span class="p">)</span> <span class="c1"># rows refer to time, columns to particle</span>
<span class="go">[[1.0, 1.0], [1.0, 1.0], [1.0, 0.0], [0.5, 0.5]]</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">timeseries</span><span class="p">)</span>
<span class="go">[[True, True], [True, True], [True, False], [True, True]]</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
<p>Note that the average of  the characteristic function
<img class="math" src="_images/math/fe0bfc3d8e7d7ed05b0b0820f31c21f9689d3eda.png" alt="h(t)"/> is done over all trajectories, including those
that start with <img class="math" src="_images/math/6884acaf627f996ecd93b8d02ac18beaf238dfdb.png" alt="h=0"/>.
The correlation <img class="math" src="_images/math/9690dce5ecd2207c3f07bbc78b9877797363854b.png" alt="\langle h(t)h(0) \rangle"/> is divided
by the average <img class="math" src="_images/math/7cca9cd0d7f8b4f5b64b0c4fea475262150d2b63.png" alt="\langle h \rangle"/> computed over all
trajectores that extend up to a time lag <img class="math" src="_images/math/907a4add6d5db5b7f197f7924f1371b8ac404fe6.png" alt="t"/>. The
<cite>normalize</cite> switch has no effect.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># normalized, continuous</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">corr</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">correlation</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">corr</span><span class="p">,</span> <span class="p">[</span> <span class="mf">7.</span><span class="o">/</span><span class="mi">7</span><span class="p">,</span> <span class="mf">4.</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span> <span class="mf">2.</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="mf">1.</span><span class="o">/</span><span class="mi">2</span><span class="p">]))</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># normalized, intermittent</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">corr</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">correlation</span><span class="p">(</span><span class="n">continuous</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">corr</span><span class="p">,</span> <span class="p">[</span> <span class="mf">7.</span><span class="o">/</span><span class="mi">7</span><span class="p">,</span> <span class="mf">4.</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span> <span class="mf">3.</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="mf">2.</span><span class="o">/</span><span class="mi">2</span> <span class="p">]))</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The autocorrelation functions are calculated by taking
into account in the average only those trajectory that
start with <img class="math" src="_images/math/54e960e3085e4335667a50e7dd45787a222c5680.png" alt="h=1"/> (i.e., which start within the reference
group). The normalization is done by dividing the
correlation at time lag <img class="math" src="_images/math/907a4add6d5db5b7f197f7924f1371b8ac404fe6.png" alt="t"/> by its value at time lag 0
computed over all trajectories that extend up to time
lag <img class="math" src="_images/math/907a4add6d5db5b7f197f7924f1371b8ac404fe6.png" alt="t"/> and do not start with <img class="math" src="_images/math/6884acaf627f996ecd93b8d02ac18beaf238dfdb.png" alt="h=0"/>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># not normalizd, intermittent</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">corr</span> <span class="o">=</span> <span class="n">vv</span><span class="o">.</span><span class="n">correlation</span><span class="p">(</span><span class="n">normalized</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">continuous</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c0</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="mf">0.25</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="mf">0.25</span><span class="p">)</span><span class="o">/</span><span class="mi">7</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="mf">0.5</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">5</span> <span class="p">;</span> <span class="n">c2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mf">0.5</span><span class="o">+</span><span class="mf">0.5</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span> <span class="p">;</span> <span class="n">c3</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.5</span><span class="o">+</span><span class="mf">0.5</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">corr</span><span class="p">,</span> <span class="p">[</span> <span class="n">c0</span><span class="p">,</span> <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">,</span> <span class="n">c3</span><span class="p">]))</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># check normalization</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">vv</span><span class="o">.</span><span class="n">correlation</span><span class="p">(</span><span class="n">continuous</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">==</span> <span class="n">corr</span><span class="o">/</span><span class="n">corr</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># not normalizd, continuous</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">corr</span> <span class="o">=</span> <span class="n">vv</span><span class="o">.</span><span class="n">correlation</span><span class="p">(</span><span class="n">normalized</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">continuous</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c0</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="mf">0.25</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="mf">0.25</span><span class="p">)</span><span class="o">/</span><span class="mi">7</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="mf">0.5</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">5</span> <span class="p">;</span> <span class="n">c2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mf">0.5</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span> <span class="p">;</span> <span class="n">c3</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.5</span><span class="o">+</span><span class="mf">0.</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">corr</span><span class="p">,</span> <span class="p">[</span> <span class="n">c0</span><span class="p">,</span> <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">,</span> <span class="n">c3</span><span class="p">]))</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># check normalization</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">vv</span><span class="o">.</span><span class="n">correlation</span><span class="p">(</span><span class="n">continuous</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span> <span class="n">corr</span><span class="o">/</span><span class="n">corr</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="contact-angles">
<h2>Contact Angles<a class="headerlink" href="#contact-angles" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pytim.observables.ContactAngle">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pytim.observables.</span></span><span class="sig-name descname"><span class="pre">ContactAngle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">substrate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hcut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hcut_upper</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">contact_cut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">removeCOM</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">store</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytim/observables/contactangle.html#ContactAngle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytim.observables.ContactAngle" title="Permalink to this definition">¶</a></dt>
<dd><p>ContactAngle class implementation that uses interfacial atoms to compute        droplet profiles and contact angles using different approaches.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>interface</strong> (<em>PYTIM</em>) – Compute the contact angle for this interface</p></li>
<li><p><strong>droplet</strong> (<em>AtomGroup</em>) – Atom group representative of the droplet</p></li>
<li><p><strong>substrate</strong> (<em>AtomGroup</em>) – Atom group representative of the substrate</p></li>
<li><p><strong>periodic</strong> (<em>int</em>) – direction along which the system is periodic. Default: None, not periodic                                              If None, the code performs best fit to ellipsoids, otherwise, to ellipses                                              If not None, selects the direction of the axis of macroscopic translational                                              invariance: 0:x, 1:y, 2:z</p></li>
<li><p><strong>hcut</strong> (<em>float</em>) – don’t consider contributions from atoms closer than this to the substrate                                              (used to disregard the microscopic contact angle)</p></li>
<li><p><strong>hcut_upper</strong> (<em>float</em>) – don’t consider contributions from atoms above this distance from the substrate                                              default: None</p></li>
<li><p><strong>bins</strong> (<em>int</em>) – bins used for sampling the profile</p></li>
<li><p><strong>removeCOM</strong> (<em>int</em><em> or </em><em>array_like</em>) – remove the COM motion along this direction(s). Default: None, does not remove COM motion</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">MDAnalysis</span> <span class="k">as</span> <span class="nn">mda</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytim</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pytim</span> <span class="kn">import</span> <span class="n">observables</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pytim.datafiles</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="n">WATER_DROPLET_CYLINDRICAL_GRO</span><span class="p">,</span><span class="n">WATER_DROPLET_CYLINDRICAL_XTC</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">droplet</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s2">&quot;name OW&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">substrate</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s2">&quot;name C&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inter</span> <span class="o">=</span> <span class="n">pytim</span><span class="o">.</span><span class="n">GITIM</span><span class="p">(</span><span class="n">universe</span><span class="o">=</span><span class="n">u</span><span class="p">,</span><span class="n">group</span><span class="o">=</span><span class="n">droplet</span><span class="p">,</span> <span class="n">molecular</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span><span class="n">cluster_cut</span><span class="o">=</span><span class="mf">3.4</span><span class="p">,</span> <span class="n">biggest_cluster_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Contact angle calculation using interfacial atoms, angular bining for a cylindrical droplet</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># with periodicity along the y (1) axis</span>
<span class="gp">&gt;&gt;&gt; </span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">CA</span> <span class="o">=</span> <span class="n">observables</span><span class="o">.</span><span class="n">ContactAngle</span><span class="p">(</span><span class="n">inter</span><span class="p">,</span> <span class="n">substrate</span><span class="p">,</span> <span class="n">periodic</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">bins</span><span class="o">=</span><span class="mi">397</span><span class="p">,</span><span class="n">removeCOM</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">hcut</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">ts</span> <span class="ow">in</span> <span class="n">u</span><span class="o">.</span><span class="n">trajectory</span><span class="p">[::]:</span>
<span class="gp">... </span>    <span class="n">CA</span><span class="o">.</span><span class="n">sample</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Instantaneous contact angle (last frame) by fitting a circle...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">CA</span><span class="o">.</span><span class="n">contact_angle</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="go">90.58</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># ... and using an elliptical fit:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">left</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="n">CA</span><span class="o">.</span><span class="n">contact_angles</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># left angle</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">left</span><span class="p">),</span><span class="mi">2</span><span class="p">)</span>
<span class="go">79.95</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># right angle</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">right</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="go">83.84</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Contact angles from the averaged binned statistics of</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># surface atoms&#39; radial distance as a function of the azimuthal angle</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">CA</span><span class="o">.</span><span class="n">mean_contact_angles</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="go">[96.2, 100.68]</span>
</pre></div>
</div>
<dl class="py property">
<dt class="sig sig-object py" id="pytim.observables.ContactAngle.contact_angle">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">contact_angle</span></span><a class="headerlink" href="#pytim.observables.ContactAngle.contact_angle" title="Permalink to this definition">¶</a></dt>
<dd><p>The contact angle from the best-fititng circumference or sphere
computed using the current frame</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pytim.observables.ContactAngle.mean_contact_angle">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mean_contact_angle</span></span><a class="headerlink" href="#pytim.observables.ContactAngle.mean_contact_angle" title="Permalink to this definition">¶</a></dt>
<dd><p>The contact angle from the best-fititng circumference 
computed using the location of the interface averaged 
over the sampled frames</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pytim.observables.ContactAngle.contact_angles">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">contact_angles</span></span><a class="headerlink" href="#pytim.observables.ContactAngle.contact_angles" title="Permalink to this definition">¶</a></dt>
<dd><p>The contact angles from the best-fititng ellipse or 
ellipsoid computed using the current frame</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pytim.observables.ContactAngle.mean_contact_angles">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mean_contact_angles</span></span><a class="headerlink" href="#pytim.observables.ContactAngle.mean_contact_angles" title="Permalink to this definition">¶</a></dt>
<dd><p>The contact angles from the best-fititng ellipse or 
ellipsoid computed using the location of the interface 
averaged over the sampled frames</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytim.observables.ContactAngle.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytim/observables/contactangle.html#ContactAngle.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytim.observables.ContactAngle.sample" title="Permalink to this definition">¶</a></dt>
<dd><p>samples the profile of a droplet, stores
the current atomic coordinates of the liquid surface
not in contact with the substrate in the reference
frame of the droplet, and optionally the coordinates
along the whole trajectory.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytim.observables.ContactAngle.rmsd_ellipsoid">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">rmsd_ellipsoid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_coeffs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytim/observables/contactangle.html#ContactAngle.rmsd_ellipsoid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytim.observables.ContactAngle.rmsd_ellipsoid" title="Permalink to this definition">¶</a></dt>
<dd><p>RMSD between the points x and the ellipsoid defined by the general            parameters p of the associated polynomial.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p</strong> (<em>list</em>) – general coefficients [a,b,c,f,g,h,p,q,r,d]</p></li>
<li><p><strong>x</strong> (<em>ndarray</em>) – points coordinates as a (x,3)-ndarray</p></li>
<li><p><strong>N</strong> (<em>int</em>) – number of points on the ellipsoid that are                                         generated and used to compute the rmsd</p></li>
<li><p><strong>check_coeffs</strong> (<em>bool</em>) – if true, perform additional checks</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytim.observables.ContactAngle.ellipse">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ellipse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parmsc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6.283185307179586</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytim/observables/contactangle.html#ContactAngle.ellipse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytim.observables.ContactAngle.ellipse" title="Permalink to this definition">¶</a></dt>
<dd><p>Return npts points on the ellipse described by the canonical parameters            x0, y0, ap, bp, e, phi for values of the paramter between tmin and tmax.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>parmsc</strong> (<em>dict</em>) – dictionary with keys: x0,y0,a,b,phi</p></li>
<li><p><strong>tmin</strong> (<em>float</em>) – minimum value of the parameter</p></li>
<li><p><strong>tmax</strong> (<em>float</em>) – maximum value of the parameter</p></li>
<li><p><strong>npts</strong> (<em>int</em>) – number of points to use</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Tuple<span class="colon">:</span></dt>
<dd class="field-odd"><p>(x,y):       coordinates as numpy arrays</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytim.observables.ContactAngle.circle">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">circle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parmsc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6.283185307179586</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytim/observables/contactangle.html#ContactAngle.circle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytim.observables.ContactAngle.circle" title="Permalink to this definition">¶</a></dt>
<dd><p>Return npts points on the circle described by the canonical parameters
R, x0, y0 for values of the paramter between tmin and tmax.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>parmsc</strong> (<em>dict</em>) – dictionary with keys: R, x0, y0</p></li>
<li><p><strong>tmin</strong> (<em>float</em>) – minimum value of the parameter</p></li>
<li><p><strong>tmax</strong> (<em>float</em>) – maximum value of the parameter</p></li>
<li><p><strong>npts</strong> (<em>int</em>) – number of points to use</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Tuple<span class="colon">:</span></dt>
<dd class="field-odd"><p>(x,y): coordinates as numpy arrays</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytim.observables.ContactAngle.ellipsoid">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ellipsoid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parmsc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytim/observables/contactangle.html#ContactAngle.ellipsoid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytim.observables.ContactAngle.ellipsoid" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute npts points on the ellipsoid described by the affine parameters T, v</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>parmsc</strong> (<em>dict</em>) – dictionary with keys: T (3x3 matrix), v (3x1 vector)</p></li>
<li><p><strong>npts</strong> (<em>int</em>) – number of points to use</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Tuple<span class="colon">:</span></dt>
<dd class="field-odd"><p>(x,y,z)     : coordinates of points on the ellipsoid as ndarrays</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytim.observables.ContactAngle.sample_theta_R">
<span class="sig-name descname"><span class="pre">sample_theta_R</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytim/observables/contactangle.html#ContactAngle.sample_theta_R"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytim.observables.ContactAngle.sample_theta_R" title="Permalink to this definition">¶</a></dt>
<dd><p>given a set of angles (theta), radii (r) and elevations (h), compute the mean profile h(r)
by taking the binned average values of h and r.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytim.observables.ContactAngle.fit_circle">
<span class="sig-name descname"><span class="pre">fit_circle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">use</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'frame'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nonlinear</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytim/observables/contactangle.html#ContactAngle.fit_circle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytim.observables.ContactAngle.fit_circle" title="Permalink to this definition">¶</a></dt>
<dd><p>fit an arc through the profile h(r) sampled by the class</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>use</strong> (<em>str</em>) – ‘frame’    : use the positions of the current frame only (default)                              ‘histogram’: use the binned values sampled so far                              ‘stored’   : use the stored surface atoms positions, if the option store=True was passed at initialization</p></li>
<li><p><strong>bins</strong> (<em>int</em>) – the number of bins to use along the symmetry direction (cylinder axis, azimuthal angle)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>a list including, for each of the bins:</p>
<dl class="field-list simple">
<dt class="field-odd">tuple<span class="colon">:</span></dt>
<dd class="field-odd"><p>radius, base radius, cos(theta), center</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytim.observables.ContactAngle.fit_ellipse">
<span class="sig-name descname"><span class="pre">fit_ellipse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">use</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'frame'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nonlinear</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytim/observables/contactangle.html#ContactAngle.fit_ellipse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytim.observables.ContactAngle.fit_ellipse" title="Permalink to this definition">¶</a></dt>
<dd><p>fit an ellipse through the points sampled by the class. See implementation details in _fit_ellipsoid()</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>use</strong> (<em>str</em>) – ‘frame’    : use the positions of the current frame only (default)                              ‘histogram’: use the binned values sampled so far                              ‘stored’   : use the stored surface atoms positions, if the option store=True                                           was passed at initialization</p></li>
<li><p><strong>bins</strong> (<em>int</em>) – the number of bins to use along the symmetry direction (cylinder axis, azimuthal angle)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>a list including, for each of the bins, a tuple with elements:</p>
<dl class="field-list simple">
<dt class="field-odd">list<span class="colon">:</span></dt>
<dd class="field-odd"><p>parms:  parameters of the ellipse polynomial in general form:                              a[0] x^2 + a[1] x y + a[2] y^2 + a[3] x + a[4] y = 0</p>
</dd>
<dt class="field-even">dict<span class="colon">:</span></dt>
<dd class="field-even"><p>parmsc: dictionary of parameters in canoncial form: (a,b, x0,y0,phi, e)                              with a,b the major and minor semiaxes, x0,y0 the center, phi  the angle                              (in rad) between x axis and major axis, and e the eccentricity.</p>
</dd>
<dt class="field-odd">list<span class="colon">:</span></dt>
<dd class="field-odd"><p>theta:  [left contact angle, right contact angle]</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytim.observables.ContactAngle.fit_ellipsoid">
<span class="sig-name descname"><span class="pre">fit_ellipsoid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">use</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'frame'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nonlinear</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytim/observables/contactangle.html#ContactAngle.fit_ellipsoid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytim.observables.ContactAngle.fit_ellipsoid" title="Permalink to this definition">¶</a></dt>
<dd><p>fit an ellipsoid through the points sampled by the class. See implementation details in _fit_ellipsoid()</p>
<p>:param str   use        : ‘frame’    : use the positions of the current frame only (default)                                      ‘histogram’: use the binned values sampled so far                                      ‘stored’   : use the stored surface atoms positions, if the option store=True                                                   was passed at initialization
:param int   bins       : the number of bins to use along the symmetry direction (cylinder axis, azimuthal angle)</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>a list with a tuple (parms,parmsc,theta, rmsd) for each of the bins;                          If only one bin is present, return just the tuple.</p>
<dl class="field-list simple">
<dt class="field-odd">array<span class="colon">:</span></dt>
<dd class="field-odd"><p>parms  : array of parameters of the ellipsoid equation in general form:                             a[0] x^2 + a[1] y^2 + a[2] z^2 + a[3] yz + a[4] xz +                              a[5] xy  + a[6] x + a[7] y + a[8] z + a[9] = 0, otherwise.</p>
</dd>
<dt class="field-even">dict<span class="colon">:</span></dt>
<dd class="field-even"><p>parmsc : dictionary with parameters of the ellipsoid affine form (T,v),                          such that the ellipsoid points are                                         r  = T s + v,                          if s are points from the unit sphere centered in the origin.</p>
</dd>
<dt class="field-odd">float<span class="colon">:</span></dt>
<dd class="field-odd"><p>theta  : the contact angle as a function of the azimuthal angle phi from phi=0, aligned                          with (-1,0,0) to 2 pi.</p>
</dd>
<dt class="field-even">float<span class="colon">:</span></dt>
<dd class="field-even"><p>rmsd   : the rmsd to the best fit (linear or nonlinear) ellipsoid</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="d-distributions">
<h2>3D Distributions<a class="headerlink" href="#d-distributions" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pytim.observables.DistributionFunction">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pytim.observables.</span></span><span class="sig-name descname"><span class="pre">DistributionFunction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">universe</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">75</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">generalized_coordinate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">generalized_coordinate2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observable2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_distance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords_in</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['x',</span> <span class="pre">'y',</span> <span class="pre">'z']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['x',</span> <span class="pre">'y',</span> <span class="pre">'z']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kargs1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kargs2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytim/observables/distributionfunction.html#DistributionFunction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytim.observables.DistributionFunction" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates a 3d distribution function of some observable from two
groups.</p>
<p>The two functions must return an array (of scalars or of vectors)
having the same size of the group. The scalar product between the
two functions is used to weight the distriution function.</p>
<div class="math">
<p><img src="_images/math/b6805ea35a03f0876a5c8fd6094f60db2c2ba4bb.png" alt="sdf(x,y,z) = \frac{1}{N}\left\langle \sum_{i\neq j} \delta(x-x_i,y-y_i,z-z_i)\
  f_1(r_i,v_i)\cdot f_2(r_j,v_j) \right\rangle"/></p>
</div><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>max_distance</strong> (<em>double</em>) – compute the sdf up to this distance along 
the axes. If a list or an array is supplied,
each element will determine the maximum distance
along each axis.
If ‘full’ is supplied (default) computes
it up to half of the smallest box side.</p></li>
<li><p><strong>nbins</strong> (<em>int</em>) – number of bins used for the sampling in all directions. 
Supply a list or an array to use a different number of
bins along each of the directions</p></li>
<li><p><strong>observable</strong> (<em>Observable</em>) – observable for the first group</p></li>
<li><p><strong>observable2</strong> (<em>Observable</em>) – observable for the second group</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">MDAnalysis</span> <span class="k">as</span> <span class="nn">mda</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytim</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pytim</span> <span class="kn">import</span> <span class="n">observables</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pytim.datafiles</span> <span class="kn">import</span> <span class="o">*</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="n">WATER_GRO</span><span class="p">,</span><span class="n">WATER_XTC</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">oxygens</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s2">&quot;name OW&quot;</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nres</span> <span class="o">=</span> <span class="n">observables</span><span class="o">.</span><span class="n">NumberOfResidues</span><span class="p">()</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdf</span> <span class="o">=</span> <span class="n">observables</span><span class="o">.</span><span class="n">RDF</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">nbins</span><span class="o">=</span><span class="mi">120</span><span class="p">,</span><span class="n">observable</span><span class="o">=</span><span class="n">nres</span><span class="p">,</span><span class="n">observable2</span><span class="o">=</span><span class="n">nres</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">interface</span> <span class="o">=</span> <span class="n">pytim</span><span class="o">.</span><span class="n">ITIM</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">2.</span><span class="p">,</span><span class="n">group</span><span class="o">=</span><span class="n">oxygens</span><span class="p">,</span><span class="n">cluster_cut</span><span class="o">=</span><span class="mf">3.5</span><span class="p">,</span><span class="n">molecular</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">ts</span> <span class="ow">in</span> <span class="n">u</span><span class="o">.</span><span class="n">trajectory</span><span class="p">[::</span><span class="mi">50</span><span class="p">]:</span>
<span class="gp">... </span>    <span class="n">layer</span><span class="o">=</span><span class="n">interface</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">... </span>    <span class="n">rdf</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">layer</span><span class="p">,</span><span class="n">layer</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdf</span><span class="o">.</span><span class="n">count</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="s1">&#39;RDF3D.dat&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">rdf</span><span class="o">.</span><span class="n">bins</span><span class="p">,</span><span class="n">rdf</span><span class="o">.</span><span class="n">rdf</span><span class="p">)))</span>
</pre></div>
</div>
<p>Note that one needs to specify neither both groups, not both observables.
If only the first group (observable) is specified, the second is assumed
to be the same as the first, as in the following example:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rdf1</span> <span class="o">=</span> <span class="n">observables</span><span class="o">.</span><span class="n">RDF</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">observable</span><span class="o">=</span><span class="n">nres</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdf2</span> <span class="o">=</span> <span class="n">observables</span><span class="o">.</span><span class="n">RDF</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">observable</span><span class="o">=</span><span class="n">nres</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdf3</span> <span class="o">=</span> <span class="n">observables</span><span class="o">.</span><span class="n">RDF</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">observable</span><span class="o">=</span><span class="n">nres</span><span class="p">,</span><span class="n">observable2</span><span class="o">=</span><span class="n">nres</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdf1</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">layer</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdf2</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">layer</span><span class="p">,</span><span class="n">layer</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdf3</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">layer</span><span class="p">,</span><span class="n">layer</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">rdf1</span><span class="o">.</span><span class="n">rdf</span><span class="p">[:]</span><span class="o">==</span><span class="n">rdf2</span><span class="o">.</span><span class="n">rdf</span><span class="p">[:]))</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">rdf1</span><span class="o">.</span><span class="n">rdf</span><span class="p">[:]</span><span class="o">==</span><span class="n">rdf3</span><span class="o">.</span><span class="n">rdf</span><span class="p">[:]))</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="free-volume">
<h2>Free Volume<a class="headerlink" href="#free-volume" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pytim.observables.FreeVolume">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pytim.observables.</span></span><span class="sig-name descname"><span class="pre">FreeVolume</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">universe</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npoints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytim/observables/free_volume.html#FreeVolume"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytim.observables.FreeVolume" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the fraction of free volume in the system, or its profile.</p>
<p>Note that this does not fit in the usual observable class as it can not be
expressed as a property of particles, and needs some kind of gridding to be calculated.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>universe</strong> (<em>Universe</em>) – the universe</p></li>
<li><p><strong>npoints</strong> (<em>int</em>) – number of Monte Carlo sampling points (default: 10x the number of atoms in the universe)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Tuple<span class="colon">:</span></dt>
<dd class="field-odd"><p>free volume, error : A tuple with the free volume and the estimated error</p>
</dd>
</dl>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">MDAnalysis</span> <span class="k">as</span> <span class="nn">mda</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytim</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pytim.datafiles</span> <span class="kn">import</span> <span class="n">CCL4_WATER_GRO</span><span class="p">,</span> <span class="n">_TEST_BCC_GRO</span>
<span class="gp">&gt;&gt;&gt; </span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="n">CCL4_WATER_GRO</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inter</span> <span class="o">=</span> <span class="n">pytim</span><span class="o">.</span><span class="n">ITIM</span><span class="p">(</span><span class="n">u</span><span class="p">)</span> <span class="c1"># just to make sure all radii are set</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># ensure reproducibility of test</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FV</span> <span class="o">=</span> <span class="n">pytim</span><span class="o">.</span><span class="n">observables</span><span class="o">.</span><span class="n">FreeVolume</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bins</span><span class="p">,</span> <span class="n">prof</span> <span class="p">,</span><span class="n">err</span> <span class="o">=</span> <span class="n">FV</span><span class="o">.</span><span class="n">compute_profile</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">free</span><span class="p">,</span> <span class="n">err</span> <span class="o">=</span> <span class="n">FV</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;</span><span class="si">{:0.3f}</span><span class="s1"> +/- </span><span class="si">{:0.3f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">free</span><span class="p">,</span><span class="n">err</span><span class="p">))</span>
<span class="go">0.431 +/- 0.001</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># strict test on bcc volume fraction</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="n">_TEST_BCC_GRO</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># we add some random gitter to avoid singular matrices</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">positions</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">positions</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span><span class="o">*</span><span class="mf">1e-5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inter</span> <span class="o">=</span> <span class="n">pytim</span><span class="o">.</span><span class="n">GITIM</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">radii_dict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;C&#39;</span><span class="p">:</span><span class="mf">10.</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">3.</span><span class="p">)</span><span class="o">/</span><span class="mf">4.</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nsamples</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">1e5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FV</span> <span class="o">=</span> <span class="n">pytim</span><span class="o">.</span><span class="n">observables</span><span class="o">.</span><span class="n">FreeVolume</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">npoints</span> <span class="o">=</span> <span class="n">nsamples</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># ensure reproducibility of test</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">free</span><span class="p">,</span> <span class="n">err</span> <span class="o">=</span> <span class="n">FV</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">free</span><span class="p">,</span><span class="mf">1.0</span><span class="o">-</span><span class="mf">0.6802</span><span class="p">,</span><span class="n">rtol</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># ensure reproducibility of test</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lst</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">FV</span><span class="o">.</span><span class="n">_compute</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">free</span><span class="p">,</span><span class="mf">1.0</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">lst</span><span class="p">)</span><span class="o">*</span><span class="mf">1.0</span><span class="o">/</span><span class="n">nsamples</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="pytim.observables.FreeVolume.compute_profile">
<span class="sig-name descname"><span class="pre">compute_profile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">direction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytim/observables/free_volume.html#FreeVolume.compute_profile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytim.observables.FreeVolume.compute_profile" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute a profile of the free volume fraction</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inp</strong> (<em>AtomGroup</em>) – compute the volume fraction of this group, None selects the complete universe</p></li>
<li><p><strong>nbins</strong> (<em>int</em>) – number of bins, by default 30</p></li>
<li><p><strong>direction</strong> (<em>int</em>) – direction along wich to compute the the profile, z (2) by default</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Tuple<span class="colon">:</span></dt>
<dd class="field-odd"><p>bins,fraction,error: the left limit of the bins, the free volume fraction in each bin, the associated std deviation</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytim.observables.FreeVolume.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytim/observables/free_volume.html#FreeVolume.compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytim.observables.FreeVolume.compute" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the total free volume fraction in the simulation box</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inp</strong> (<em>AtomGroup</em>) – compute the volume fraction of this group, None selects the complete universe</p></li>
<li><p><strong>nbins</strong> (<em>int</em>) – number of bins, by default 30</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Tuple<span class="colon">:</span></dt>
<dd class="field-odd"><p>fraction, error: the free volume fraction and associated error</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="local-reference-frame">
<h2>Local Reference Frame<a class="headerlink" href="#local-reference-frame" title="Permalink to this heading">¶</a></h2>
</section>
<section id="misc">
<h2>Misc<a class="headerlink" href="#misc" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pytim.observables.IntrinsicDistance">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pytim.observables.</span></span><span class="sig-name descname"><span class="pre">IntrinsicDistance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">interface</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symmetry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytim/observables/intrinsic_distance.html#IntrinsicDistance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytim.observables.IntrinsicDistance" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the intrinsic distance calculation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>interface</strong> (<em>PYTIM</em>) – compute the intrinsic distance with respect
to this interface</p></li>
<li><p><strong>symmetry</strong> (<em>str</em>) – force calculation using this symmetry, if
availabe (e.g. ‘generic’, ‘planar’, ‘spherical’)
If ‘default’, uses the symmetry selected in
the PYTIM interface instance.</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">MDAnalysis</span> <span class="k">as</span> <span class="nn">mda</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytim</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pytim</span> <span class="kn">import</span> <span class="n">observables</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pytim.datafiles</span> <span class="kn">import</span> <span class="n">MICELLE_PDB</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="n">MICELLE_PDB</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">micelle</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;resname DPC&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">waterox</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;type O and resname SOL&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inter</span> <span class="o">=</span> <span class="n">pytim</span><span class="o">.</span><span class="n">GITIM</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">group</span><span class="o">=</span><span class="n">micelle</span><span class="p">,</span> <span class="n">molecular</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist</span>  <span class="o">=</span> <span class="n">observables</span><span class="o">.</span><span class="n">IntrinsicDistance</span><span class="p">(</span><span class="n">interface</span><span class="o">=</span><span class="n">inter</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">dist</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">waterox</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">threshold</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="go">[25.733  8.579  8.852 ... 18.566 13.709  9.876]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">threshold</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="pytim.observables.IntrinsicDistance.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytim/observables/intrinsic_distance.html#IntrinsicDistance.compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytim.observables.IntrinsicDistance.compute" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the intrinsic distance of a set of points from the first
layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>positions</strong> (<em>ndarray</em>) – compute the intrinsic distance for this set
of points</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pytim.observables.LayerTriangulation">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pytim.observables.</span></span><span class="sig-name descname"><span class="pre">LayerTriangulation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">interface</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_triangulation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_statistics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytim/observables/layer_triangulation.html#LayerTriangulation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytim.observables.LayerTriangulation" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the triangulation of the surface and some associated
quantities. Notice that this forces the interface to be centered
in the box.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>universe</strong> (<em>Universe</em>) – the MDAnalysis universe</p></li>
<li><p><strong>interface</strong> (<a class="reference internal" href="ITIM.html#pytim.itim.ITIM" title="pytim.itim.ITIM"><em>ITIM</em></a>) – compute the triangulation with respect to it</p></li>
<li><p><strong>layer</strong> (<em>int</em>) – (default: 1) compute the triangulation with
respect to this layer of the interface</p></li>
<li><p><strong>return_triangulation</strong> (<em>bool</em>) – (default: True) return the Delaunay
triangulation used for the interpolation</p></li>
<li><p><strong>return_statistics</strong> (<em>bool</em>) – (default: True) return the Delaunay
triangulation used for the interpolation</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Observable LayerTriangulation</p>
</dd>
</dl>
<p>Example:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytim</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">MDAnalysis</span> <span class="k">as</span> <span class="nn">mda</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pytim.datafiles</span> <span class="kn">import</span> <span class="n">WATER_GRO</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">interface</span> <span class="o">=</span> <span class="n">pytim</span><span class="o">.</span><span class="n">ITIM</span><span class="p">(</span><span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="n">WATER_GRO</span><span class="p">),</span><span class="n">molecular</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">surface</span>   <span class="o">=</span> <span class="n">pytim</span><span class="o">.</span><span class="n">observables</span><span class="o">.</span><span class="n">LayerTriangulation</span><span class="p">(</span>                            <span class="n">interface</span><span class="p">,</span><span class="n">return_triangulation</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stats</span>     <span class="o">=</span> <span class="n">surface</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Surface= </span><span class="si">{:04.0f}</span><span class="s2"> A^2&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">stats</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<span class="go">Surface= 6328 A^2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pytim.observables.LocalReferenceFrame">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pytim.observables.</span></span><span class="sig-name descname"><span class="pre">LocalReferenceFrame</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">arg</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwarg</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytim/observables/local_frame.html#LocalReferenceFrame"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytim.observables.LocalReferenceFrame" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the local surface using a definition based on that of
S. O. Yesylevskyy and C. Ramsey, Phys.Chem.Chem.Phys., 2014, 16, 17052
modified to include a guess for the surface normal direction</p>
<p>Example (note that this example started failing on the last output
line with opposite signs for x and y. Could be an instability of 
the SVD, thus the test is removed from the docstring):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">MDAnalysis</span> <span class="k">as</span> <span class="nn">mda</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytim</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pytim.datafiles</span> <span class="kn">import</span> <span class="n">WATER_GRO</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="o">=</span><span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="n">WATER_GRO</span><span class="p">)</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;name OW&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inter</span> <span class="o">=</span> <span class="n">pytim</span><span class="o">.</span><span class="n">ITIM</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="n">molecular</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span> <span class="o">=</span> <span class="n">pytim</span><span class="o">.</span><span class="n">observables</span><span class="o">.</span><span class="n">LocalReferenceFrame</span><span class="p">()</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span><span class="n">threshold</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">suppress</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span> 
<span class="go">[[[-0.330383  0.740913 -0.584718]</span>
<span class="go">  [-0.937619 -0.328689  0.113291]</span>
<span class="go">  [ 0.108252 -0.585672 -0.803287]]</span>

<span class="go"> [[-0.98614   0.164904  0.018286]</span>
<span class="go">  [-0.146148 -0.811192 -0.566223]</span>
<span class="go">  [ 0.078538  0.561048 -0.824049]]</span>

<span class="go"> [[-0.921816 -0.28798  -0.259465]</span>
<span class="go">  [ 0.182384 -0.912875  0.365233]</span>
<span class="go">  [ 0.342039 -0.289355 -0.894026]]</span>

<span class="go"> ...</span>

<span class="go"> [[-0.740137 -0.557695  0.375731]</span>
<span class="go">  [ 0.369404  0.129692  0.920174]</span>
<span class="go">  [-0.561906  0.819852  0.110024]]</span>

<span class="go"> [[-0.198256 -0.724093  0.660594]</span>
<span class="go">  [ 0.64637  -0.603238 -0.467236]</span>
<span class="go">  [-0.736818 -0.334356 -0.587627]]</span>

<span class="go"> [[ 0.268257 -0.337893 -0.902146]</span>
<span class="go">  [ 0.233933 -0.885591  0.401253]</span>
<span class="go">  [-0.934513 -0.31868  -0.158522]]]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">()</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="pytim.observables.LocalReferenceFrame.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytim/observables/local_frame.html#LocalReferenceFrame.compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytim.observables.LocalReferenceFrame.compute" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the local reference frame</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>inp</strong> (<em>AtomGroup</em>) – the group of atoms that define the surface</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a (len(inp),3,3) set of coordinates defining
the local axes, with the slice [:2:] defining
the normal vectors</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="basic-observables">
<h2>Basic Observables<a class="headerlink" href="#basic-observables" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pytim.observables.Charge">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pytim.observables.</span></span><span class="sig-name descname"><span class="pre">Charge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">arg</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwarg</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytim/observables/basic_observables.html#Charge"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytim.observables.Charge" title="Permalink to this definition">¶</a></dt>
<dd><p>Atomic charges</p>
<dl class="py method">
<dt class="sig sig-object py" id="pytim.observables.Charge.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytim/observables/basic_observables.html#Charge.compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytim.observables.Charge.compute" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the observable.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>inp</strong> (<em>AtomGroup</em>) – the input atom group</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an array of charges for each atom in the group</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pytim.observables.Force">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pytim.observables.</span></span><span class="sig-name descname"><span class="pre">Force</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'xyz'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwarg</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytim/observables/basic_observables.html#Force"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytim.observables.Force" title="Permalink to this definition">¶</a></dt>
<dd><p>Atomic forces</p>
<dl class="py method">
<dt class="sig sig-object py" id="pytim.observables.Force.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytim/observables/basic_observables.html#Force.compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytim.observables.Force.compute" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the observable.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>inp</strong> (<em>AtomGroup</em>) – the input atom group</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>atomic forces</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pytim.observables.Mass">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pytim.observables.</span></span><span class="sig-name descname"><span class="pre">Mass</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">arg</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwarg</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytim/observables/basic_observables.html#Mass"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytim.observables.Mass" title="Permalink to this definition">¶</a></dt>
<dd><p>Atomic masses</p>
<dl class="py method">
<dt class="sig sig-object py" id="pytim.observables.Mass.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytim/observables/basic_observables.html#Mass.compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytim.observables.Mass.compute" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the observable.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>inp</strong> (<em>AtomGroup</em>) – the input atom group</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an array of masses for each atom in the group</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pytim.observables.Number">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pytim.observables.</span></span><span class="sig-name descname"><span class="pre">Number</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">arg</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwarg</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytim/observables/basic_observables.html#Number"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytim.observables.Number" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of atoms.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pytim.observables.Number.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytim/observables/basic_observables.html#Number.compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytim.observables.Number.compute" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the observable.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>inp</strong> (<em>AtomGroup</em>) – the input atom group</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>one, for each atom in the group</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pytim.observables.NumberOfResidues">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pytim.observables.</span></span><span class="sig-name descname"><span class="pre">NumberOfResidues</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">arg</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">karg</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytim/observables/basic_observables.html#NumberOfResidues"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytim.observables.NumberOfResidues" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of residues.</p>
<p>Instead of associating 1 to the center of mass of the residue, we
associate 1/(number of atoms in residue) to each atom. In an
homogeneous system, these two definitions are (on average)
equivalent. If the system is not homogeneous, this is not true
anymore.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pytim.observables.NumberOfResidues.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytim/observables/basic_observables.html#NumberOfResidues.compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytim.observables.NumberOfResidues.compute" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the observable.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>inp</strong> (<em>AtomGroup</em>) – the input atom group</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>one, for each residue in the group</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pytim.observables.Orientation">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pytim.observables.</span></span><span class="sig-name descname"><span class="pre">Orientation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">universe</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytim/observables/orientation.html#Orientation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytim.observables.Orientation" title="Permalink to this definition">¶</a></dt>
<dd><p>Orientation of a group of points.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>options</strong> (<em>str</em>) – optional string. If <cite>normal</cite> is passed, the
orientation of the normal vectors is computed
If the option ‘molecular’ is passed at initialization
the coordinates of the second and third atoms are
folded around those of the first.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pytim.observables.Orientation.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytim/observables/orientation.html#Orientation.compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytim.observables.Orientation.compute" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the observable.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>inp</strong> (<em>ndarray</em>) – the input atom group. The length must be a multiple
of three</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the orientation vectors</p>
</dd>
</dl>
<p>For each triplet of positions A1,A2,A3, computes the unit vector
between A2-A1 and  A3-A1 or, if the option ‘normal’ is passed at
initialization, the unit vector normal to the plane spanned by the
three vectors.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pytim.observables.Position">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pytim.observables.</span></span><span class="sig-name descname"><span class="pre">Position</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'xyz'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwarg</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytim/observables/basic_observables.html#Position"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytim.observables.Position" title="Permalink to this definition">¶</a></dt>
<dd><p>Atomic positions</p>
<p>Example: compute the projection on the xz plane of the first water molecule</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">MDAnalysis</span> <span class="k">as</span> <span class="nn">mda</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytim</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="n">pytim</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">WATER_GRO</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">proj</span> <span class="o">=</span> <span class="n">pytim</span><span class="o">.</span><span class="n">observables</span><span class="o">.</span><span class="n">Position</span><span class="p">(</span><span class="s1">&#39;xz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">np</span><span class="o">.</span><span class="n">printoptions</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">proj</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">residues</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">atoms</span><span class="p">)</span> <span class="p">)</span>
<span class="go">[[28.62 11.37]</span>
<span class="go"> [28.42 10.51]</span>
<span class="go"> [29.61 11.51]]</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="pytim.observables.Position.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inp</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwarg</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytim/observables/basic_observables.html#Position.compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytim.observables.Position.compute" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the observable.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>inp</strong> (<em>AtomGroup</em>) – the input atom group</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>atomic positions</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pytim.observables.Velocity">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pytim.observables.</span></span><span class="sig-name descname"><span class="pre">Velocity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'xyz'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwarg</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytim/observables/basic_observables.html#Velocity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytim.observables.Velocity" title="Permalink to this definition">¶</a></dt>
<dd><p>Atomic velocities</p>
<dl class="py method">
<dt class="sig sig-object py" id="pytim.observables.Velocity.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pytim/observables/basic_observables.html#Velocity.compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytim.observables.Velocity.compute" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the observable.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>inp</strong> (<em>AtomGroup</em>) – the input atom group</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>atomic velocities</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<ul class="simple">
<li><p><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></p></li>
<li><p><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></p></li>
<li><p><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></p></li>
</ul>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-92682414-1', 'auto');
  ga('send', 'pageview');

</script>

</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/logo.png" alt="Logo"/>
            </a></p>
<h3><a href="index.html">Table of Contents</a></h3>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="quick.html">Pytim: Quick Tour</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">How to Install Pytim</a></li>
<li class="toctree-l1"><a class="reference internal" href="micelle.html">Surface of a micelle</a></li>
<li class="toctree-l1"><a class="reference internal" href="center.html">To center or not to center?</a></li>
<li class="toctree-l1"><a class="reference internal" href="guessing_radii.html">Choosing the atomic radii</a></li>
<li class="toctree-l1"><a class="reference internal" href="newproperties.html">New properties of Atoms</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Modules</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="ITIM.html">ITIM</a></li>
<li class="toctree-l1"><a class="reference internal" href="GITIM.html">GITIM</a></li>
<li class="toctree-l1"><a class="reference internal" href="SASA.html">SASA</a></li>
<li class="toctree-l1"><a class="reference internal" href="WillardChandler.html">WillardChandler</a></li>
<li class="toctree-l1"><a class="reference internal" href="SimpleInterface.html">SimpleInterface</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Observables</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-pytim.observables.rdf">Radial Distribution Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-rdf">Module: RDF</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-rdf2d">Module: RDF2D</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-pytim.observables.profile">Profiles</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-profile">Module: Profile</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#time-correlation-functions">Time Correlation Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#contact-angles">Contact Angles</a></li>
<li class="toctree-l2"><a class="reference internal" href="#d-distributions">3D Distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#free-volume">Free Volume</a></li>
<li class="toctree-l2"><a class="reference internal" href="#local-reference-frame">Local Reference Frame</a></li>
<li class="toctree-l2"><a class="reference internal" href="#misc">Misc</a></li>
<li class="toctree-l2"><a class="reference internal" href="#basic-observables">Basic Observables</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="datafiles.html">Datafiles</a></li>
<li class="toctree-l1"><a class="reference internal" href="utilities.html">Utilities</a></li>
</ul>

  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="SimpleInterface.html"
                          title="previous chapter">SimpleInterface</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="datafiles.html"
                          title="next chapter">Datafiles</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/observables.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="datafiles.html" title="Datafiles"
             >next</a> |</li>
        <li class="right" >
          <a href="SimpleInterface.html" title="SimpleInterface"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Pytim 1.0.0 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Observables</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2017, Marcello Sega.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.1.1.
    </div>
  </body>
</html>