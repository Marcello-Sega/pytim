
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Observables &#8212; Pytim 0.6.3 documentation</title>
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.6.3',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="shortcut icon" href="_static/pytim.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Datafiles" href="datafiles.html" />
    <link rel="prev" title="ChaconTarazona" href="ChaconTarazona.html" /> 
  </head>
  <body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="datafiles.html" title="Datafiles"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="ChaconTarazona.html" title="ChaconTarazona"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Pytim 0.6.3 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="observables">
<h1>Observables<a class="headerlink" href="#observables" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-pytim.rdf">
<span id="radial-distribution-functions"></span><h2>Radial Distribution Functions<a class="headerlink" href="#module-pytim.rdf" title="Permalink to this headline">¶</a></h2>
<div class="section" id="module-rdf">
<h3>Module: rdf<a class="headerlink" href="#module-rdf" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="pytim.rdf.RDF">
<em class="property">class </em><code class="descclassname">pytim.rdf.</code><code class="descname">RDF</code><span class="sig-paren">(</span><em>universe</em>, <em>nbins=75</em>, <em>max_radius='full'</em>, <em>start=None</em>, <em>stop=None</em>, <em>step=None</em>, <em>observable=None</em>, <em>observable2=None</em>, <em>kargs1=None</em>, <em>kargs2=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytim.rdf.RDF" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates a radial distribution function of some observable from two
groups.</p>
<p>The two functions must return an array (of scalars or of vectors)
having the same size of the group. The scalar product between the
two functions is used to weight the distriution function.</p>
<div class="math">
<p><img src="_images/math/17ace18f0c1d4736b4b560c1640b7aa30e82205a.png" alt="g(r) = \frac{1}{N}\left\langle \sum_{i\neq j} \delta(r-|r_i-r_j|)            f_1(r_i,v_i)\cdot f_2(r_j,v_j) \right\rangle"/></p>
</div><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>max_radius</strong> (<em>double</em>) – compute the rdf up to this distance.
If ‘full’ is supplied (default) computes
it up to half of the smallest box side.</li>
<li><strong>nbins</strong> (<em>int</em>) – number of bins</li>
<li><strong>observable</strong> (<em>Observable</em>) – observable for the first group</li>
<li><strong>observable2</strong> (<em>Observable</em>) – observable for the second group</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">MDAnalysis</span> <span class="k">as</span> <span class="nn">mda</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytim</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pytim</span> <span class="k">import</span> <span class="n">observables</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pytim.datafiles</span> <span class="k">import</span> <span class="o">*</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="n">WATER_GRO</span><span class="p">,</span><span class="n">WATER_XTC</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">oxygens</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s2">&quot;name OW&quot;</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nres</span> <span class="o">=</span> <span class="n">observables</span><span class="o">.</span><span class="n">NumberOfResidues</span><span class="p">()</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdf</span> <span class="o">=</span> <span class="n">observables</span><span class="o">.</span><span class="n">RDF</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">nbins</span><span class="o">=</span><span class="mi">120</span><span class="p">,</span>        <span class="n">observable</span><span class="o">=</span><span class="n">nres</span><span class="p">,</span><span class="n">observable2</span><span class="o">=</span><span class="n">nres</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">interface</span> <span class="o">=</span> <span class="n">pytim</span><span class="o">.</span><span class="n">ITIM</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">2.</span><span class="p">,</span><span class="n">group</span><span class="o">=</span><span class="n">oxygens</span><span class="p">,</span>        <span class="n">cluster_cut</span><span class="o">=</span><span class="mf">3.5</span><span class="p">,</span><span class="n">molecular</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">ts</span> <span class="ow">in</span> <span class="n">u</span><span class="o">.</span><span class="n">trajectory</span><span class="p">[::</span><span class="mi">50</span><span class="p">]:</span>
<span class="gp">... </span>    <span class="n">layer</span><span class="o">=</span><span class="n">interface</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">... </span>    <span class="n">rdf</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">layer</span><span class="p">,</span><span class="n">layer</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdf</span><span class="o">.</span><span class="n">count</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="s1">&#39;RDF3D.dat&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">rdf</span><span class="o">.</span><span class="n">bins</span><span class="p">,</span><span class="n">rdf</span><span class="o">.</span><span class="n">rdf</span><span class="p">)))</span>
</pre></div>
</div>
<p>Note that one needs to specify neither both groups, not both observables.
If only the first group (observable) is specified, the second is assumed
to be the same as the first, as in the following example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rdf1</span> <span class="o">=</span> <span class="n">observables</span><span class="o">.</span><span class="n">RDF</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">observable</span><span class="o">=</span><span class="n">nres</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdf2</span> <span class="o">=</span> <span class="n">observables</span><span class="o">.</span><span class="n">RDF</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">observable</span><span class="o">=</span><span class="n">nres</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdf3</span> <span class="o">=</span> <span class="n">observables</span><span class="o">.</span><span class="n">RDF</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">observable</span><span class="o">=</span><span class="n">nres</span><span class="p">,</span><span class="n">observable2</span><span class="o">=</span><span class="n">nres</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdf1</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">layer</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdf2</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">layer</span><span class="p">,</span><span class="n">layer</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdf3</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">layer</span><span class="p">,</span><span class="n">layer</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">rdf1</span><span class="o">.</span><span class="n">rdf</span><span class="p">[:]</span><span class="o">==</span><span class="n">rdf2</span><span class="o">.</span><span class="n">rdf</span><span class="p">[:]))</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">rdf1</span><span class="o">.</span><span class="n">rdf</span><span class="p">[:]</span><span class="o">==</span><span class="n">rdf3</span><span class="o">.</span><span class="n">rdf</span><span class="p">[:]))</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="pytim.rdf.RDF2D">
<em class="property">class </em><code class="descclassname">pytim.rdf.</code><code class="descname">RDF2D</code><span class="sig-paren">(</span><em>universe</em>, <em>nbins=75</em>, <em>max_radius='full'</em>, <em>start=None</em>, <em>stop=None</em>, <em>step=None</em>, <em>excluded_dir='auto'</em>, <em>true2D=False</em>, <em>observable=None</em>, <em>kargs1=None</em>, <em>kargs2=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytim.rdf.RDF2D" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates a radial distribution function of some observable from two
groups, projected on a plane.</p>
<p>The two functions must return an array (of scalars or of vectors)
having the same size of the group. The scalar product between the
two functions is used to weight the distriution function.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>nbins</strong> (<em>int</em>) – number of bins</li>
<li><strong>excluded_dir</strong> (<em>char</em>) – project position vectors onto the plane
orthogonal to ‘z’,’y’ or ‘z’</li>
<li><strong>observable</strong> (<em>Observable</em>) – observable for group 1</li>
<li><strong>observable2</strong> (<em>Observable</em>) – observable for group 2</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">MDAnalysis</span> <span class="k">as</span> <span class="nn">mda</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytim</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pytim</span> <span class="k">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pytim.datafiles</span> <span class="k">import</span> <span class="o">*</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="n">WATER_GRO</span><span class="p">,</span><span class="n">WATER_XTC</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">oxygens</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s2">&quot;name OW&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">interface</span> <span class="o">=</span> <span class="n">pytim</span><span class="o">.</span><span class="n">ITIM</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">2.</span><span class="p">,</span><span class="n">group</span><span class="o">=</span><span class="n">oxygens</span><span class="p">,</span>        <span class="n">cluster_cut</span><span class="o">=</span><span class="mf">3.5</span><span class="p">,</span><span class="n">molecular</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdf</span> <span class="o">=</span> <span class="n">observables</span><span class="o">.</span><span class="n">RDF2D</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">nbins</span><span class="o">=</span><span class="mi">250</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">ts</span> <span class="ow">in</span> <span class="n">u</span><span class="o">.</span><span class="n">trajectory</span><span class="p">[::</span><span class="mi">50</span><span class="p">]</span> <span class="p">:</span>
<span class="gp">... </span>    <span class="n">layer</span><span class="o">=</span><span class="n">interface</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">... </span>    <span class="n">rdf</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">layer</span><span class="p">,</span><span class="n">layer</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdf</span><span class="o">.</span><span class="n">count</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="s1">&#39;RDF.dat&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">rdf</span><span class="o">.</span><span class="n">bins</span><span class="p">,</span><span class="n">rdf</span><span class="o">.</span><span class="n">rdf</span><span class="p">)))</span>
</pre></div>
</div>
<p>This results in the following RDF (sampling more frequently):</p>
<p>(<a class="reference external" href=".//observables-1.py">Source code</a>, <a class="reference external" href=".//observables-1.png">png</a>, <a class="reference external" href=".//observables-1.hires.png">hires.png</a>, <a class="reference external" href=".//observables-1.pdf">pdf</a>)</p>
<div class="figure">
<img alt="_images/observables-1.png" src="_images/observables-1.png" />
</div>
</dd></dl>

</div>
</div>
<div class="section" id="profiles">
<h2>Profiles<a class="headerlink" href="#profiles" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="time-correlation-functions">
<h2>Time Correlation Functions<a class="headerlink" href="#time-correlation-functions" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="pytim.observables.Correlator">
<em class="property">class </em><code class="descclassname">pytim.observables.</code><code class="descname">Correlator</code><span class="sig-paren">(</span><em>universe=None</em>, <em>observable=None</em>, <em>reference=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytim.observables.Correlator" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the (self) correlation of an observable (scalar or vector)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>observable</strong> (<em>Observable</em>) – compute the autocorrelation of this observable.
If the observable is None and the reference
is not, the survival probability is computed.</li>
<li><strong>normalize</strong> (<em>bool</em>) – normalize the correlation to 1 at t=0</li>
<li><strong>reference</strong> (<em>AtomGroup</em>) – if the group passed to the sample() function
changes its composition along the trajectory
(such as a layer group), a reference group that
includes all atoms that could appear in the
variable group must be passed, in order to
provide a proper normalization. See the example
below.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytim</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">MDAnalysis</span> <span class="k">as</span> <span class="nn">mda</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pytim.datafiles</span> <span class="k">import</span> <span class="n">WATERSMALL_GRO</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pytim.utilities</span> <span class="k">import</span> <span class="n">lap</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#  tmpdir here is specified only for travis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">WATERSMALL_TRR</span> <span class="o">=</span> <span class="n">pytim</span><span class="o">.</span><span class="n">datafiles</span><span class="o">.</span><span class="n">pytim_data</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="s1">&#39;WATERSMALL_LONG_TRR&#39;</span><span class="p">,</span><span class="n">tmpdir</span><span class="o">=</span><span class="s1">&#39;./&#39;</span><span class="p">)</span> 
<span class="go">checking presence of a cached copy...</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">u</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="n">WATERSMALL_GRO</span><span class="p">,</span><span class="n">WATERSMALL_TRR</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;name OW&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">velocity</span> <span class="o">=</span> <span class="n">pytim</span><span class="o">.</span><span class="n">observables</span><span class="o">.</span><span class="n">Velocity</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">corr</span> <span class="o">=</span> <span class="n">pytim</span><span class="o">.</span><span class="n">observables</span><span class="o">.</span><span class="n">Correlator</span><span class="p">(</span><span class="n">observable</span><span class="o">=</span><span class="n">velocity</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">u</span><span class="o">.</span><span class="n">trajectory</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
<span class="gp">... </span>    <span class="n">corr</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vacf</span> <span class="o">=</span> <span class="n">corr</span><span class="o">.</span><span class="n">correlation</span><span class="p">()</span>
</pre></div>
</div>
<p>This produces the following (steps of 1 fs):</p>
<p>(<a class="reference external" href=".//observables-2.py">Source code</a>, <a class="reference external" href=".//observables-2.png">png</a>, <a class="reference external" href=".//observables-2.hires.png">hires.png</a>, <a class="reference external" href=".//observables-2.pdf">pdf</a>)</p>
<div class="figure">
<img alt="_images/observables-2.png" src="_images/observables-2.png" />
</div>
<p>In order to compute the correlation for variable groups, one should proceed
as follows:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">corr</span> <span class="o">=</span> <span class="n">pytim</span><span class="o">.</span><span class="n">observables</span><span class="o">.</span><span class="n">Correlator</span><span class="p">(</span><span class="n">observable</span><span class="o">=</span><span class="n">velocity</span><span class="p">,</span><span class="n">reference</span><span class="o">=</span><span class="n">g</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># notice the molecular=False switch, in order for the</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># layer group to be made of oxygen atoms only and match</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># the reference group</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inter</span> <span class="o">=</span> <span class="n">pytim</span><span class="o">.</span><span class="n">ITIM</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">group</span><span class="o">=</span><span class="n">g</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span><span class="n">molecular</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># example only: sample longer for smooth results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">u</span><span class="o">.</span><span class="n">trajectory</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">10</span><span class="p">]:</span>
<span class="gp">... </span>    <span class="n">corr</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">inter</span><span class="o">.</span><span class="n">atoms</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">layer_vacf</span> <span class="o">=</span> <span class="n">corr</span><span class="o">.</span><span class="n">correlation</span><span class="p">()</span>
</pre></div>
</div>
<p>In order to compute the survival probability of some atoms in a layer, it
is possible to pass observable=None together with the reference group:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">corr</span> <span class="o">=</span> <span class="n">pytim</span><span class="o">.</span><span class="n">observables</span><span class="o">.</span><span class="n">Correlator</span><span class="p">(</span><span class="n">observable</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">reference</span> <span class="o">=</span> <span class="n">g</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inter</span> <span class="o">=</span> <span class="n">pytim</span><span class="o">.</span><span class="n">ITIM</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">group</span><span class="o">=</span><span class="n">g</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">molecular</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span> <span class="c1"># example only: sample longer for smooth results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">u</span><span class="o">.</span><span class="n">trajectory</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">10</span><span class="p">]:</span>
<span class="gp">... </span>    <span class="n">corr</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">inter</span><span class="o">.</span><span class="n">atoms</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">survival</span> <span class="o">=</span> <span class="n">corr</span><span class="o">.</span><span class="n">correlation</span><span class="p">()</span>
</pre></div>
</div>
<dl class="method">
<dt id="pytim.observables.Correlator.correlation">
<code class="descname">correlation</code><span class="sig-paren">(</span><em>normalized=True</em>, <em>continuous=True</em><span class="sig-paren">)</span><a class="headerlink" href="#pytim.observables.Correlator.correlation" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the autocorrelation from the sampled data</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>normalized</strong> (<em>bool</em>) – normalize the correlation function to:
its zero-time value for regular
correlations; to the average of the
characteristic function for the
survival probability.</li>
<li><strong>continuous</strong> (<em>bool</em>) – applies only when a reference group has
been specified: if True (default) the
contribution of a particle at time lag
$tau=t_1-t_0$ is considered only if
the particle did not leave the
reference group between $t_0$ and
$t_1$. If False, the intermittent
correlation is calculated, and the
above restriction is released.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># We build a fake trajectory to test the various options:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">MDAnalysis</span> <span class="k">as</span> <span class="nn">mda</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytim</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pytim.datafiles</span> <span class="k">import</span> <span class="n">WATER_GRO</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pytim.observables</span> <span class="k">import</span> <span class="n">Correlator</span><span class="p">,</span> <span class="n">Velocity</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">suppress</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="n">WATER_GRO</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="o">.</span><span class="n">velocities</span><span class="o">*=</span><span class="mf">0.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="o">.</span><span class="n">velocities</span><span class="o">+=</span><span class="mf">1.0</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># velocity autocorrelation along x, variable group</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vv</span> <span class="o">=</span> <span class="n">Correlator</span><span class="p">(</span><span class="n">observable</span><span class="o">=</span><span class="n">Velocity</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">reference</span><span class="o">=</span><span class="n">g</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nn</span> <span class="o">=</span> <span class="n">Correlator</span><span class="p">(</span><span class="n">reference</span><span class="o">=</span><span class="n">g</span><span class="p">)</span> <span class="c1"># survival probability in group g</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="p">[</span><span class="n">vv</span><span class="p">,</span><span class="n">nn</span><span class="p">]:</span>
<span class="gp">... </span>    <span class="n">c</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>     <span class="c1"># t=0</span>
<span class="gp">... </span>    <span class="n">c</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>     <span class="c1"># t=1</span>
<span class="gp">... </span>    <span class="n">c</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">g</span><span class="p">[:</span><span class="mi">1</span><span class="p">])</span> <span class="c1"># t=2, exclude the second particle</span>
<span class="gp">... </span>    <span class="n">g</span><span class="o">.</span><span class="n">velocities</span> <span class="o">/=</span> <span class="mf">2.</span> <span class="c1"># from now on v=0.5</span>
<span class="gp">... </span>    <span class="n">c</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>     <span class="c1"># t=3</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
<p>The timeseries sampled can be accessed using:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">vv</span><span class="o">.</span><span class="n">timeseries</span><span class="p">)</span> <span class="c1"># rows refer to time, columns to particle</span>
<span class="go">[[1.0, 1.0], [1.0, 1.0], [1.0, 0.0], [0.5, 0.5]]</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">timeseries</span><span class="p">)</span>
<span class="go">[[True, True], [True, True], [True, False], [True, True]]</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
<p>Note that the average of  the characteristic function
$h(t)$ is done over all trajectories, including those
that start with h=0. The correlation $&lt; h(t) h(0) &gt;$
is divided by the average $&lt;h&gt;$ computed over all
trajectores that extend up to a time lag $t$. The
<cite>normalize</cite> switch has no effect.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># normalized, continuous</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">corr</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">correlation</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">corr</span><span class="p">,</span> <span class="p">[</span> <span class="mf">7.</span><span class="o">/</span><span class="mi">7</span><span class="p">,</span> <span class="mf">4.</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span> <span class="mf">2.</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="mf">1.</span><span class="o">/</span><span class="mi">2</span><span class="p">]))</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># normalized, intermittent</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">corr</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">correlation</span><span class="p">(</span><span class="n">continuous</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">corr</span><span class="p">,</span> <span class="p">[</span> <span class="mf">7.</span><span class="o">/</span><span class="mi">7</span><span class="p">,</span> <span class="mf">4.</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span> <span class="mf">3.</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="mf">2.</span><span class="o">/</span><span class="mi">2</span> <span class="p">]))</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The autocorrelation functions are calculated by taking
into account in the average only those trajectory that
start with $h=1$ (i.e., which start within the reference
group). The normalization is done by dividing the
correlation at time lag $t$ by its value at time lag 0
computed over all trajectories that extend up to time
lag $t$ and do not start with $h=0$.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># not normalizd, intermittent</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">corr</span> <span class="o">=</span> <span class="n">vv</span><span class="o">.</span><span class="n">correlation</span><span class="p">(</span><span class="n">normalized</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">continuous</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c0</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="mf">0.25</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="mf">0.25</span><span class="p">)</span><span class="o">/</span><span class="mi">7</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="mf">0.5</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">5</span> <span class="p">;</span> <span class="n">c2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mf">0.5</span><span class="o">+</span><span class="mf">0.5</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span> <span class="p">;</span> <span class="n">c3</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.5</span><span class="o">+</span><span class="mf">0.5</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">corr</span><span class="p">,</span> <span class="p">[</span> <span class="n">c0</span><span class="p">,</span> <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">,</span> <span class="n">c3</span><span class="p">]))</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># check normalization</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">vv</span><span class="o">.</span><span class="n">correlation</span><span class="p">(</span><span class="n">continuous</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">==</span> <span class="n">corr</span><span class="o">/</span><span class="n">corr</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># not normalizd, continuous</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">corr</span> <span class="o">=</span> <span class="n">vv</span><span class="o">.</span><span class="n">correlation</span><span class="p">(</span><span class="n">normalized</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">continuous</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c0</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="mf">0.25</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="mf">0.25</span><span class="p">)</span><span class="o">/</span><span class="mi">7</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="mf">0.5</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">5</span> <span class="p">;</span> <span class="n">c2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mf">0.5</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span> <span class="p">;</span> <span class="n">c3</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.5</span><span class="o">+</span><span class="mf">0.</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">corr</span><span class="p">,</span> <span class="p">[</span> <span class="n">c0</span><span class="p">,</span> <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">,</span> <span class="n">c3</span><span class="p">]))</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># check normalization</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">vv</span><span class="o">.</span><span class="n">correlation</span><span class="p">(</span><span class="n">continuous</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span> <span class="n">corr</span><span class="o">/</span><span class="n">corr</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pytim.observables.Correlator.sample">
<code class="descname">sample</code><span class="sig-paren">(</span><em>group</em><span class="sig-paren">)</span><a class="headerlink" href="#pytim.observables.Correlator.sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Sample the timeseries for the autocorrelation function</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>group</strong> (<em>AtomGroup</em>) – compute the observable using this group</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="misc">
<h2>Misc<a class="headerlink" href="#misc" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="pytim.observables.LayerTriangulation">
<em class="property">class </em><code class="descclassname">pytim.observables.</code><code class="descname">LayerTriangulation</code><span class="sig-paren">(</span><em>interface</em>, <em>return_triangulation=True</em>, <em>return_statistics=True</em><span class="sig-paren">)</span><a class="headerlink" href="#pytim.observables.LayerTriangulation" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the triangulation of the surface and some associated
quantities. Notice that this forces the interface to be centered
in the box.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>universe</strong> (<em>Universe</em>) – the MDAnalysis universe</li>
<li><strong>interface</strong> (<a class="reference internal" href="ITIM.html#pytim.itim.ITIM" title="pytim.itim.ITIM"><em>ITIM</em></a>) – compute the triangulation with respect to it</li>
<li><strong>layer</strong> (<em>int</em>) – (default: 1) compute the triangulation with
respect to this layer of the interface</li>
<li><strong>return_triangulation</strong> (<em>bool</em>) – (default: True) return the Delaunay
triangulation used for the interpolation</li>
<li><strong>return_statistics</strong> (<em>bool</em>) – (default: True) return the Delaunay
triangulation used for the interpolation</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Observable LayerTriangulation</p>
</td>
</tr>
</tbody>
</table>
<p>Example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytim</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">MDAnalysis</span> <span class="k">as</span> <span class="nn">mda</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pytim.datafiles</span> <span class="k">import</span> <span class="n">WATER_GRO</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">interface</span> <span class="o">=</span> <span class="n">pytim</span><span class="o">.</span><span class="n">ITIM</span><span class="p">(</span><span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="n">WATER_GRO</span><span class="p">),</span><span class="n">molecular</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">surface</span>   <span class="o">=</span> <span class="n">pytim</span><span class="o">.</span><span class="n">observables</span><span class="o">.</span><span class="n">LayerTriangulation</span><span class="p">(</span>                            <span class="n">interface</span><span class="p">,</span><span class="n">return_triangulation</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stats</span>     <span class="o">=</span> <span class="n">surface</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Surface= </span><span class="si">{:04.0f}</span><span class="s2"> A^2&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">stats</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<span class="go">Surface= 6328 A^2</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="pytim.observables.IntrinsicDistance">
<em class="property">class </em><code class="descclassname">pytim.observables.</code><code class="descname">IntrinsicDistance</code><span class="sig-paren">(</span><em>interface</em>, <em>symmetry='default'</em><span class="sig-paren">)</span><a class="headerlink" href="#pytim.observables.IntrinsicDistance" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the intrinsic distance calculation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>interface</strong> (<em>PYTIM</em>) – compute the intrinsic distance with respect
to this interface</li>
<li><strong>symmetry</strong> (<em>str</em>) – force calculation using this symmetry, if
availabe (e.g. ‘generic’, ‘planar’, ‘spherical’)
If ‘default’, uses the symmetry selected in
the PYTIM interface instance.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">MDAnalysis</span> <span class="k">as</span> <span class="nn">mda</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytim</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pytim</span> <span class="k">import</span> <span class="n">observables</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pytim.datafiles</span> <span class="k">import</span> <span class="n">MICELLE_PDB</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="n">MICELLE_PDB</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">micelle</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;resname DPC&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">waterox</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;type O and resname SOL&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inter</span> <span class="o">=</span> <span class="n">pytim</span><span class="o">.</span><span class="n">GITIM</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">group</span><span class="o">=</span><span class="n">micelle</span><span class="p">,</span> <span class="n">molecular</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist</span>  <span class="o">=</span> <span class="n">observables</span><span class="o">.</span><span class="n">IntrinsicDistance</span><span class="p">(</span><span class="n">interface</span><span class="o">=</span><span class="n">inter</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">dist</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">waterox</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="go">[25.733  8.579  8.852 ... 18.566 13.709  9.876]</span>
</pre></div>
</div>
<dl class="method">
<dt id="pytim.observables.IntrinsicDistance.compute">
<code class="descname">compute</code><span class="sig-paren">(</span><em>inp</em>, <em>kargs=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytim.observables.IntrinsicDistance.compute" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the intrinsic distance of a set of points from the first
layers.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>positions</strong> (<em>ndarray</em>) – compute the intrinsic distance for this set
of points</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="basic-observables">
<h2>Basic Observables<a class="headerlink" href="#basic-observables" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="pytim.observables.Number">
<em class="property">class </em><code class="descclassname">pytim.observables.</code><code class="descname">Number</code><span class="sig-paren">(</span><em>*arg</em>, <em>**kwarg</em><span class="sig-paren">)</span><a class="headerlink" href="#pytim.observables.Number" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of atoms.</p>
<dl class="method">
<dt id="pytim.observables.Number.compute">
<code class="descname">compute</code><span class="sig-paren">(</span><em>inp</em>, <em>kargs=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytim.observables.Number.compute" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the observable.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>inp</strong> (<em>AtomGroup</em>) – the input atom group</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">one, for each atom in the group</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pytim.observables.NumberOfResidues">
<em class="property">class </em><code class="descclassname">pytim.observables.</code><code class="descname">NumberOfResidues</code><span class="sig-paren">(</span><em>*arg</em>, <em>**karg</em><span class="sig-paren">)</span><a class="headerlink" href="#pytim.observables.NumberOfResidues" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of residues.</p>
<p>Instead of associating 1 to the center of mass of the residue, we
associate 1/(number of atoms in residue) to each atom. In an
homogeneous system, these two definitions are (on average)
equivalent. If the system is not homogeneous, this is not true
anymore.</p>
<dl class="method">
<dt id="pytim.observables.NumberOfResidues.compute">
<code class="descname">compute</code><span class="sig-paren">(</span><em>inp</em>, <em>kargs=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytim.observables.NumberOfResidues.compute" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the observable.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>inp</strong> (<em>AtomGroup</em>) – the input atom group</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">one, for each residue in the group</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pytim.observables.Position">
<em class="property">class </em><code class="descclassname">pytim.observables.</code><code class="descname">Position</code><span class="sig-paren">(</span><em>*arg</em>, <em>**kwarg</em><span class="sig-paren">)</span><a class="headerlink" href="#pytim.observables.Position" title="Permalink to this definition">¶</a></dt>
<dd><p>Atomic positions</p>
<dl class="method">
<dt id="pytim.observables.Position.compute">
<code class="descname">compute</code><span class="sig-paren">(</span><em>inp</em>, <em>kargs=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytim.observables.Position.compute" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the observable.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>inp</strong> (<em>AtomGroup</em>) – the input atom group</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">atomic positions</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pytim.observables.Velocity">
<em class="property">class </em><code class="descclassname">pytim.observables.</code><code class="descname">Velocity</code><span class="sig-paren">(</span><em>*arg</em>, <em>**kwarg</em><span class="sig-paren">)</span><a class="headerlink" href="#pytim.observables.Velocity" title="Permalink to this definition">¶</a></dt>
<dd><p>Atomic velocities</p>
<dl class="method">
<dt id="pytim.observables.Velocity.compute">
<code class="descname">compute</code><span class="sig-paren">(</span><em>inp</em>, <em>kargs=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytim.observables.Velocity.compute" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the observable.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>inp</strong> (<em>AtomGroup</em>) – the input atom group</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">atomic velocities</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pytim.observables.Force">
<em class="property">class </em><code class="descclassname">pytim.observables.</code><code class="descname">Force</code><span class="sig-paren">(</span><em>*arg</em>, <em>**kwarg</em><span class="sig-paren">)</span><a class="headerlink" href="#pytim.observables.Force" title="Permalink to this definition">¶</a></dt>
<dd><p>Atomic forces</p>
<dl class="method">
<dt id="pytim.observables.Force.compute">
<code class="descname">compute</code><span class="sig-paren">(</span><em>inp</em>, <em>kargs=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytim.observables.Force.compute" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the observable.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>inp</strong> (<em>AtomGroup</em>) – the input atom group</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">atomic forces</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pytim.observables.Orientation">
<em class="property">class </em><code class="descclassname">pytim.observables.</code><code class="descname">Orientation</code><span class="sig-paren">(</span><em>universe</em>, <em>options=''</em><span class="sig-paren">)</span><a class="headerlink" href="#pytim.observables.Orientation" title="Permalink to this definition">¶</a></dt>
<dd><p>Orientation of a group of points.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>options</strong> (<em>str</em>) – optional string. If <cite>normal</cite> is passed, the
orientation of the normal vectors is computed
If the option ‘molecular’ is passed at initialization
the coordinates of the second and third atoms are
folded around those of the first.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="pytim.observables.Orientation.compute">
<code class="descname">compute</code><span class="sig-paren">(</span><em>inp</em>, <em>kargs=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pytim.observables.Orientation.compute" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the observable.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>inp</strong> (<em>ndarray</em>) – the input atom group. The length be a multiple
of three</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">the orientation vectors</td>
</tr>
</tbody>
</table>
<p>For each triplet of positions A1,A2,A3, computes the unit vector
beteeen A2-A1 and  A3-A1 or, if the option ‘normal’ is passed at
initialization, the unit vector normal to the plane spanned by the
three vectors.</p>
</dd></dl>

</dd></dl>

<ul class="simple">
<li><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></li>
<li><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></li>
<li><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></li>
</ul>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-92682414-1', 'auto');
  ga('send', 'pageview');

</script>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/logo.png" alt="Logo"/>
            </a></p>
<h3><a href="index.html">Table Of Contents</a></h3>
<p class="caption"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="quick.html">Pytim: Quick Tour</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">How to Install Pytim</a></li>
<li class="toctree-l1"><a class="reference internal" href="micelle.html">Surface of a micelle</a></li>
<li class="toctree-l1"><a class="reference internal" href="center.html">To center or not to center?</a></li>
<li class="toctree-l1"><a class="reference internal" href="guessing_radii.html">Choosing the atomic radii</a></li>
<li class="toctree-l1"><a class="reference internal" href="newproperties.html">New properties of Atoms</a></li>
</ul>
<p class="caption"><span class="caption-text">Modules</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="ITIM.html">ITIM</a></li>
<li class="toctree-l1"><a class="reference internal" href="GITIM.html">GITIM</a></li>
<li class="toctree-l1"><a class="reference internal" href="WillardChandler.html">WillardChandler</a></li>
<li class="toctree-l1"><a class="reference internal" href="ChaconTarazona.html">ChaconTarazona</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Observables</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-pytim.rdf">Radial Distribution Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-rdf">Module: rdf</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#profiles">Profiles</a></li>
<li class="toctree-l2"><a class="reference internal" href="#time-correlation-functions">Time Correlation Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#misc">Misc</a></li>
<li class="toctree-l2"><a class="reference internal" href="#basic-observables">Basic Observables</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="datafiles.html">Datafiles</a></li>
<li class="toctree-l1"><a class="reference internal" href="utilities.html">Utilities</a></li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="ChaconTarazona.html"
                        title="previous chapter">ChaconTarazona</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="datafiles.html"
                        title="next chapter">Datafiles</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/observables.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="datafiles.html" title="Datafiles"
             >next</a> |</li>
        <li class="right" >
          <a href="ChaconTarazona.html" title="ChaconTarazona"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Pytim 0.6.3 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2017, Marcello Sega.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.5.
    </div>
  </body>
</html>